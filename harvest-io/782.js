"use strict";(self.webpackChunkgame=self.webpackChunkgame||[]).push([[782],{7782:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Cc});var n=r(9477),o=r(6194),i=r(6925),a=r(3832),s=r(2782),u=r(6729),l=r.n(u);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function y(e,t,r){return(t=p(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e){var t=function(e,t){if("object"!=c(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==c(t)?t:t+""}var v=-1,d=1,b=2,m=3,w=4,g=5,k=6,P=7,S=8,O=function(){function e(){f(this,e),y(this,"LeftWall",null),y(this,"RightWall",null),y(this,"ForwardWall",null),y(this,"BackwardWall",null)}var t,r,n;return t=e,(r=[{key:"toEWallSide",value:function(){return!this.LeftWall||this.ForwardWall||this.BackwardWall?!this.ForwardWall||this.LeftWall||this.RightWall?!this.RightWall||this.ForwardWall||this.BackwardWall?!this.BackwardWall||this.RightWall||this.LeftWall?this.LeftWall&&this.ForwardWall?g:this.LeftWall&&this.BackwardWall?P:this.RightWall&&this.ForwardWall?k:this.RightWall&&this.BackwardWall?S:v:m:b:d:w}},{key:"hasAny",get:function(){return this.LeftWall||this.ForwardWall||this.RightWall||this.BackwardWall}}])&&h(t.prototype,r),n&&h(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),j=function e(){f(this,e)};y(j,"CloseWalls",O);var x=r(7319),_=r(1965);function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,F(n.key),n)}}function A(e,t){return A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},A(e,t)}function M(e){var t=E();return function(){var r,n=I(e);if(t){var o=I(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return D(this,r)}}function D(e,t){if(t&&("object"==T(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return R(e)}function R(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(E=function(){return!!e})()}function I(e){return I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},I(e)}function L(e,t,r){return(t=F(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F(e){var t=function(e,t){if("object"!=T(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==T(t)?t:t+""}var z=Math.PI,G=2*z,V=new n.Vector3,Z=new n.Euler,N=new n.Quaternion,H=(new n.Quaternion,new n.Vector3(1,0,0),new n.Vector3(0,1,0)),X=(new n.Vector3(0,0,1),function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A(e,t)}(a,e);var t,r,o,i=M(a);function a(){var e;B(this,a);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return L(R(e=i.call.apply(i,[this].concat(r))),"course",0),L(R(e),"minTurnRadius",_.d9.minTurnRadius),L(R(e),"_maxTurnSpeed",0),L(R(e),"minAllowedCourse",0),L(R(e),"maxAllowedCourse",0),L(R(e),"extraTurningSpeed",n.MathUtils.degToRad(55)),L(R(e),"harvester",null),L(R(e),"_transform",null),L(R(e),"rawCourse",0),L(R(e),"harvesterSpeed",NaN),L(R(e),"_targetCourse",void 0),L(R(e),"quaternion",new n.Quaternion),e}return t=a,r=[{key:"run",value:function(){this.rawCourse=this.targetCourse=this.course=this.harvester?this.harvester.rotation.y:0,this.minTurnRadius=_.d9.minTurnRadius,this.quaternion.setFromAxisAngle(H,this.course)}},{key:"normalizeAngles",value:function(){for(;this.course<0;)this.course+=G;for(this.course%=G;this.rawCourse<-G;)this.rawCourse+=G;for(this.rawCourse>0&&(this.rawCourse%=G);this.targetCourse<-G;)this.targetCourse+=G;this.targetCourse>0&&(this.targetCourse%=G)}},{key:"setTargetDirection",value:function(e){this.targetCourse=this.rawCourse+0}},{key:"setCourse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e!==this.targetCourse||t)if(t)this.targetCourse=this.course=this.rawCourse=e;else{for(var r=e;r<0;)r+=G;r%=G;var n=this.minAllowedCourse,o=this.maxAllowedCourse;n>o?(r>=n&&r<G||r>=0&&r<=o)&&(this.targetCourse=e):r>=n&&r<=o&&(this.targetCourse=e)}}},{key:"isCourseAllowed",value:function(e){return!this.hasRestrictions||(this.minAllowedCourse>this.maxAllowedCourse?e>=this.minAllowedCourse&&e<G||e>=0&&e<=this.maxAllowedCourse:e>=this.minAllowedCourse&&e<=this.maxAllowedCourse)}},{key:"updateCourse",value:function(e){if(this.rawCourse!==this.targetCourse){for(var t=this.rawCourse,r=this.targetCourse,n=this.maxTurnSpeed,o=r-t;o<-G;)o+=G;for(;o>G;)o-=G;for(r=t+o,this.rawCourse=this.course=this.isControlledByPlayer?x.N.LerpAngle(t,r,n*e):x.N.LerpAngle(t,r,n*e*.5);this.course<0;)this.course+=G;this.course%=G}this.normalizeAngles(),this._updateWallRestrictions()}},{key:"getDirectionCourse",value:function(e){return-V.set(0,0,-1).angleTo(e)*(Math.sign(e.x)||1)+z}},{key:"getTargetForward",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return N.setFromEuler(Z.set(0,this.targetCourse,0)),V.set(0,0,-1).applyQuaternion(N).normalize().multiplyScalar(-e),V.clone()}},{key:"_updateWallRestrictions",value:function(){if(this.minAllowedCourse=-1/0,this.maxAllowedCourse=1/0,this.harvester&&this.harvester.nearWalls&&this.harvester.nearWalls.hasAny){var e=this.harvester.nearWalls.toEWallSide(),t=.5*z;switch(e){case d:this.minAllowedCourse=3*t,this.maxAllowedCourse=1*t;break;case b:this.minAllowedCourse=2*t,this.maxAllowedCourse=0*t;break;case m:this.minAllowedCourse=1*t,this.maxAllowedCourse=3*t;break;case w:this.minAllowedCourse=0*t,this.maxAllowedCourse=2*t;break;case g:this.minAllowedCourse=0*t,this.maxAllowedCourse=1*t;break;case k:this.minAllowedCourse=3*t,this.maxAllowedCourse=0*t;break;case P:this.minAllowedCourse=1*t,this.maxAllowedCourse=2*t;break;case S:this.minAllowedCourse=2*t,this.maxAllowedCourse=3*t}}}},{key:"targetCourse",get:function(){return this._targetCourse},set:function(e){this._targetCourse=e,this.emit("TargetCourseChanged",e)}},{key:"isControlledByPlayer",get:function(){return this.harvester&&!this.harvester.isBot}},{key:"maxTurnSpeed",get:function(){return this.harvesterSpeed===this.harvester.speed||(this.harvesterSpeed=this.harvester.speed,this._maxTurnSpeed=this.harvesterSpeed/(2*Math.PI*this.minTurnRadius)),this._maxTurnSpeed}},{key:"hasRestrictions",get:function(){return!(0===this.minAllowedCourse&&this.maxAllowedCourse===G)}}],r&&C(t.prototype,r),o&&C(t,o),Object.defineProperty(t,"prototype",{writable:!1}),a}(l())),K=1,W=2,U=4,J=8;function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}function Q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Y(n.key),n)}}function Y(e){var t=function(e,t){if("object"!=q(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==q(t)?t:t+""}var $=2*Math.PI,ee=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.actor=t}var t,r,n;return t=e,r=[{key:"normalizeAngle",value:function(e){for(;e<0;)e+=$;for(;e>$;)e-=$;return e}},{key:"normalizeAngleSigned",value:function(e){for(;e<-Math.PI;)e+=$;for(;e>Math.PI;)e-=$;return e}},{key:"getAngleTo",value:function(e){var t=e.x-this.actor.position.x,r=e.z-this.actor.position.z,n=Math.atan2(r,t);return n=$-n+.5*Math.PI,this.normalizeAngle(n)}},{key:"getAnglesDiff",value:function(e,t){var r=Math.abs(e-t)%(2*Math.PI);return r>Math.PI&&(r=2*Math.PI-r),r}},{key:"canSee",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.PI/4;if(!this.actor.steerer)return!1;var r=this.getAnglesDiff(this.getAngleTo(e),this.actor.steerer.course);return r<t/2}},{key:"tick",value:function(e){}}],r&&Q(t.prototype,r),n&&Q(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();const te=ee;function re(e){return re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},re(e)}function ne(e){return function(e){if(Array.isArray(e))return ae(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ie(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oe(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=ie(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function ie(e,t){if(e){if("string"==typeof e)return ae(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ae(e,t):void 0}}function ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function se(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ve(n.key),n)}}function ue(e,t){return ue=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ue(e,t)}function le(e){var t=he();return function(){var r,n=ye(e);if(t){var o=ye(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ce(this,r)}}function ce(e,t){if(t&&("object"==re(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return fe(e)}function fe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function he(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(he=function(){return!!e})()}function ye(e){return ye=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ye(e)}function pe(e,t,r){return(t=ve(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ve(e){var t=function(e,t){if("object"!=re(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=re(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==re(t)?t:t+""}var de=_.ai,be=new n.Raycaster(new n.Vector3,new n.Vector3,0,5),me=new n.Vector3,we=new n.Vector3,ge=new n.Vector3,ke=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ue(e,t)}(a,e);var t,r,o,i=le(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),pe(fe(t=i.call(this,e)),"scanDistance",de.danger.scanDistance),pe(fe(t),"scanAngle",n.MathUtils.degToRad(de.danger.scanAngle)),pe(fe(t),"delayBetweenTurning",de.danger.delayBetweenTurning),pe(fe(t),"inDanger",!1),pe(fe(t),"lastAngle",0),t.turnDelay=t.delayBetweenTurning,t}return t=a,o=[{key:"sortByDistance",value:function(e,t){return e.distance-t.distance}}],(r=[{key:"checkMe",value:function(e){for(;e;){if(e===this.actor)return!0;if(e===this.actor.collider)return!0;if(e===this.actor.view)return!0;e=e.parent}return!1}},{key:"tick",value:function(e){if(this.turnDelay-=e,!(this.turnDelay>0)){var t,r=[],n=oe(this.actor.level.actors);try{for(n.s();!(t=n.n()).done;){var o,i,s=t.value;if(!(null===(o=this.actor)||void 0===o?void 0:o.hasSaw)||s===this.actor){var u=((null===(i=s.harvester)||void 0===i?void 0:i.getDangerousColliders())||[]).filter((function(e){return!!e}));r.push.apply(r,ne(u))}}}catch(e){n.e(e)}finally{n.f()}r.push.apply(r,ne(this.actor.level.colliders));for(var l=2*Math.PI/10,c=[],f=0;f<10;f++){me.copy(this.actor.position);var h=f*l;if(be.far=this.scanDistance,we.set(Math.cos(h),0,Math.sin(h)),ge.copy(this.actor.position),ge.add(we),this.canSee(ge,this.scanAngle)){we.normalize(),be.set(me,we);var y=be.intersectObjects(r);if(y.length){var p,v=oe(y);try{for(v.s();!(p=v.n()).done;){var d=p.value;this.checkMe(d.object)||c.push(d)}}catch(e){v.e(e)}finally{v.f()}}}}if(c.length){c.sort(a.sortByDistance);var b=c[0],m=this.getAngleTo(b.point)+Math.PI;this.actor.turnTo(m),this.turnDelay=this.delayBetweenTurning,this.lastAngle=m,this.inDanger=!0}else this.inDanger=!1}}}])&&se(t.prototype,r),o&&se(t,o),Object.defineProperty(t,"prototype",{writable:!1}),a}(te);const Pe=ke;function Se(e){return Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Se(e)}function Oe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function je(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,De(n.key),n)}}function xe(e,t){return xe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xe(e,t)}function _e(e){var t=Ce();return function(){var r,n=Ae(e);if(t){var o=Ae(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Te(this,r)}}function Te(e,t){if(t&&("object"==Se(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Be(e)}function Be(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ce(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ce=function(){return!!e})()}function Ae(e){return Ae=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ae(e)}function Me(e,t,r){return(t=De(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function De(e){var t=function(e,t){if("object"!=Se(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Se(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Se(t)?t:t+""}var Re=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xe(e,t)}(i,e);var t,r,n,o=_e(i);function i(){var e;Oe(this,i);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Me(Be(e=o.call.apply(o,[this].concat(r))),"idle",!0),e}return t=i,(r=[{key:"tick",value:function(e){this.idle&&(this.actor.turnTo(Math.random()*Math.PI*2),this.idle=!1)}}])&&je(t.prototype,r),n&&je(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(te);const Ee=Re;function Ie(e){return Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ie(e)}function Le(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Fe(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Fe(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function Fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function ze(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,We(n.key),n)}}function Ge(e,t){return Ge=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ge(e,t)}function Ve(e){var t=He();return function(){var r,n=Xe(e);if(t){var o=Xe(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Ze(this,r)}}function Ze(e,t){if(t&&("object"==Ie(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ne(e)}function Ne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function He(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(He=function(){return!!e})()}function Xe(e){return Xe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Xe(e)}function Ke(e,t,r){return(t=We(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function We(e){var t=function(e,t){if("object"!=Ie(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Ie(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ie(t)?t:t+""}var Ue=_.ai,Je=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ge(e,t)}(a,e);var t,r,o,i=Ve(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),Ke(Ne(t=i.call(this,e)),"minDelayBetweenTurning",Ue.selectPlant.minDelayBetweenTurning),Ke(Ne(t),"maxDelayBetweenTurning",Ue.selectPlant.maxDelayBetweenTurning),Ke(Ne(t),"turnDelay",0),Ke(Ne(t),"maxFieldDistance",Ue.selectPlant.scanDistance*Ue.selectPlant.scanDistance),Ke(Ne(t),"scanAngle",n.MathUtils.degToRad(Ue.selectPlant.scanAngle)),t.setNewDelay(),t}return t=a,(r=[{key:"setNewDelay",value:function(){this.turnDelay=this.minDelayBetweenTurning+Math.random()*(this.maxDelayBetweenTurning-this.minDelayBetweenTurning)}},{key:"tick",value:function(e){if(this.turnDelay-=e,!(this.turnDelay>0)){var t,r=[],n=Le(this.actor.level.fields);try{for(n.s();!(t=n.n()).done;){var o=t.value;o.cropsLeft<=0||this.actor.position.distanceToSquared(o.position)<this.maxFieldDistance&&r.push(o)}}catch(e){n.e(e)}finally{n.f()}if(r.length){for(var i=null,a=Number.MAX_VALUE,s=0,u=r;s<u.length;s++){var l,c=Le(u[s].plants);try{for(c.s();!(l=c.n()).done;){var f=l.value;if(!f.collected){var h=this.actor.position.distanceToSquared(f.worldPosition);h<a&&this.canSee(f.worldPosition,this.scanAngle)&&(a=h,i=f)}}}catch(e){c.e(e)}finally{c.f()}}if(i){var y=this.getAngleTo(i.worldPosition);this.actor.turnTo(y),this.setNewDelay()}}}}}])&&ze(t.prototype,r),o&&ze(t,o),Object.defineProperty(t,"prototype",{writable:!1}),a}(te);const qe=Je;function Qe(e){return Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qe(e)}function Ye(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return $e(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?$e(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function $e(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function et(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ut(n.key),n)}}function tt(e,t){return tt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},tt(e,t)}function rt(e){var t=it();return function(){var r,n=at(e);if(t){var o=at(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return nt(this,r)}}function nt(e,t){if(t&&("object"==Qe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ot(e)}function ot(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function it(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(it=function(){return!!e})()}function at(e){return at=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},at(e)}function st(e,t,r){return(t=ut(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ut(e){var t=function(e,t){if("object"!=Qe(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Qe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Qe(t)?t:t+""}var lt=_.ai,ct=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tt(e,t)}(a,e);var t,r,o,i=rt(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),st(ot(t=i.call(this,e)),"scanDistance",lt.sheaf.scanDistance*lt.sheaf.scanDistance),st(ot(t),"scanAngle",n.MathUtils.degToRad(lt.sheaf.scanAngle)),st(ot(t),"turnDelay",0),t.turnDelay=lt.sheaf.delayBetweenTurning,t}return t=a,(r=[{key:"tick",value:function(e){if(this.turnDelay-=e,!(this.turnDelay>0)){var t=this.actor.level.droppedSheafs;if(!(t.length<=0)){var r,n=null,o=Number.MAX_VALUE,i=Ye(t);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(this.canSee(a.position,this.scanAngle)){var s=this.actor.position.distanceToSquared(a.position);s>this.scanDistance||s<o&&(o=s,n=a)}}}catch(e){i.e(e)}finally{i.f()}if(n){var u=this.getAngleTo(n.position);this.actor.turnTo(u)}this.turnDelay=lt.sheaf.delayBetweenTurning}}}}])&&et(t.prototype,r),o&&et(t,o),Object.defineProperty(t,"prototype",{writable:!1}),a}(te);const ft=ct;function ht(e){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ht(e)}function yt(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return pt(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?pt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function pt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function vt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bt(n.key),n)}}function dt(e,t,r){return(t=bt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bt(e){var t=function(e,t){if("object"!=ht(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ht(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ht(t)?t:t+""}var mt=new n.Vector3,wt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),dt(this,"points",[]),dt(this,"buffer",[])}var t,r,o;return t=e,r=[{key:"addNextPoint",value:function(e){var t=e.clone();t.y=0,this.points.push(t)}},{key:"clear",value:function(){this.points.splice(0),this.buffer.splice(0)}},{key:"_stretchBuffer",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.buffer.length+1;this.buffer.length<e;)this.buffer.push(new n.Vector3);return e}},{key:"getTruckPositions",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];t.splice(0);var r,n=this.points.length-1,o=0,i=0,a=yt(e);try{for(a.s();!(r=a.n()).done;)for(var s=r.value,u=s+i,l=n;l>=1;l--){mt.copy(this.points[l-1]).sub(this.points[l]);var c=mt.length();if(u-c<=0){this._stretchBuffer(o+1),this.buffer[o].copy(this.points[l]).add(mt.normalize().multiplyScalar(u)),this.buffer[o].y=0,i=u,o++;break}n--,u-=c}}catch(e){a.e(e)}finally{a.f()}t.splice(o);for(var f=0;f<o;f++){var h=this.buffer[f];t.length<f?t[f].copy(h):t.push(h.clone())}return t}},{key:"trimToLength",value:function(e){for(var t=!1,r=0,n=this.points.length-1;n>=1;n--){var o=mt.copy(this.points[n-1]).sub(this.points[n]),i=o.length();if(e-=i,this._stretchBuffer(r+1),this.buffer[r].copy(this.points[n]),r++,e<=0){o.normalize().multiplyScalar(i+e),this._stretchBuffer(r+1),this.buffer[r].copy(this.points[n]).add(o),this.buffer[r].y=0,r++,t=!0;break}}if(t){this.points.splice(r);for(var a=0;a<r;a++){var s=this.buffer[r-a-1];this.points.length<a?this.points[a].copy(s):this.points.push(s.clone())}}}}],r&&vt(t.prototype,r),o&&vt(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}(),gt=r(3687),kt=r(9652),Pt=r(8153);function St(e){return St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},St(e)}function Ot(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function jt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xt(n.key),n)}}function xt(e){var t=function(e,t){if("object"!=St(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=St(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==St(t)?t:t+""}function _t(e,t){return _t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_t(e,t)}function Tt(e){var t=Ct();return function(){var r,n=At(e);if(t){var o=At(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Bt(this,r)}}function Bt(e,t){if(t&&("object"==St(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ct=function(){return!!e})()}function At(e){return At=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},At(e)}var Mt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_t(e,t)}(s,e);var t,r,n,o,i,a=Tt(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this)).scene=e,t.type="none",t}return t=s,r=[{key:"init",value:function(){}},{key:"dispose",value:function(){}},{key:"assignBodyToView",value:function(e,t){t.userData.body=e,e.userData||(e.userData={}),e.userData.view=t}},{key:"startDebug",value:function(){}},{key:"tick",value:function(e){}}],n=[{key:"init",value:(o=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})),i=function(){var e=this,t=arguments;return new Promise((function(r,n){var i=o.apply(e,t);function a(e){Ot(i,r,n,a,s,"next",e)}function s(e){Ot(i,r,n,a,s,"throw",e)}a(void 0)}))},function(){return i.apply(this,arguments)})}],r&&jt(t.prototype,r),n&&jt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(n.EventDispatcher);const Dt=Mt;function Rt(e){return Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rt(e)}function Et(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return It(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?It(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function It(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Lt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ft(n.key),n)}}function Ft(e){var t=function(e,t){if("object"!=Rt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Rt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Rt(t)?t:t+""}function zt(e,t){return zt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},zt(e,t)}function Gt(e){var t=Zt();return function(){var r,n=Nt(e);if(t){var o=Nt(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Vt(this,r)}}function Vt(e,t){if(t&&("object"==Rt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Zt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Zt=function(){return!!e})()}function Nt(e){return Nt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Nt(e)}var Ht=new gt.AO,Xt=new n.Vector3,Kt=new n.Quaternion,Wt=new n.Quaternion,Ut=new gt.zH,Jt=new gt.Fv,qt={box:"Box",sphere:"Sphere",cylinder:"Cylinder",cone:"Cylinder",capsule:"Cylinder",hull:"ConvexPolyhedron",mesh:"Trimesh"},Qt={DYNAMIC:gt.uT.DYNAMIC,KINEMATIC:gt.uT.KINEMATIC,STATIC:gt.uT.STATIC},Yt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zt(e,t)}(i,e);var t,r,n,o=Gt(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).type="cannon",t.engine=null,t.debugRenderer=null,t.bodiesToRemove=[],t.contacts=[],t}return t=i,r=[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:-9.8,z:0};this.engine=new gt.q3,this.engine.allowSleep=!1,this.broadphase=new gt._B,this.broadphase.setWorld(this.world),this.broadphase.dirty=!0,this.engine.gravity.set(e.x,e.y,e.z)}},{key:"addBody",value:function(e){this.engine.addBody(e)}},{key:"removeBody",value:function(e){this.bodiesToRemove.push(e)}},{key:"getBodyPosition",value:function(e){return e.position}},{key:"setBodyPosition",value:function(e,t){e.position.set(t.x,t.y,t.z)}},{key:"getBodyRotation",value:function(e){return e.quaternion.toEuler(Ht),{x:Ht.x,y:Ht.y,z:Ht.z}}},{key:"setBodyRotation",value:function(e,t){e.quaternion.setFromEuler(t.x,t.y,t.z)}},{key:"getBodyQuaternion",value:function(e){return e.quaternion}},{key:"setBodyQuaternion",value:function(e,t){e.quaternion.set(t.x,t.y,t.z,t.w)}},{key:"getBodyVelocity",value:function(e){return e.velocity}},{key:"setBodyVelocity",value:function(e,t){e.velocity.set(t.x,t.y,t.z)}},{key:"getBodyAngularVelocity",value:function(e){return e.angularVelocity}},{key:"setBodyAngularVelocity",value:function(e,t){e.angularVelocity.set(t.x,t.y,t.z)}},{key:"getBodyFriction",value:function(e){return e.material.friction}},{key:"setBodyFriction",value:function(e,t){e.material.friction=t}},{key:"getBodyRestitution",value:function(e){return e.material.restitution}},{key:"setBodyRestitution",value:function(e,t){e.material.restitution=t}},{key:"createCubeShape",value:function(e){return new gt.xu(new gt.AO(e.x/2,e.y/2,e.z/2))}},{key:"createCubeBody",value:function(e,t){var r=this.createCubeShape(t);return this.finalizeBodyCreation(r,e)}},{key:"createSphereShape",value:function(e){return new gt.aL(e)}},{key:"createSphereBody",value:function(e,t){var r=this.createSphereShape(t);return this.finalizeBodyCreation(r,e)}},{key:"createCylinderShape",value:function(e,t){return new gt.Ab(e,e,t,16)}},{key:"createCylinderBody",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=this.createCylinderShape(t,r);return this.finalizeBodyCreation(n,e)}},{key:"createConeShape",value:function(e,t){return new gt.Ab(1e-4,e,t,16)}},{key:"createConeBody",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=this.createConeShape(t,r);return this.finalizeBodyCreation(n,e)}},{key:"createCapsuleShape",value:function(e,t){return new gt.Ab(e,e,t,16)}},{key:"createCapsuleBody",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=this.createCapsuleShape(t,r);return this.finalizeBodyCreation(n,e)}},{key:"createCompoundBody",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=new gt.uT({mass:e}),n=0;n<t.length;n++){var o=t[n].position?new gt.AO(t[n].position.x,t[n].position.y,t[n].position.z):new gt.AO(0,0,0),i=new gt._f;t[n].rotation&&i.setFromEuler(t[n].rotation.x,t[n].rotation.y,t[n].rotation.z),t[n].quaternion&&i.set(t[n].quaternion.x,t[n].quaternion.y,t[n].quaternion.z,t[n].quaternion.w),r.addShape(t[n].shape,o,i)}return r}},{key:"createBodyFromMesh",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=qt[r.type]||"Box",o=Pt.J7(e,{type:n});return this.finalizeBodyCreation(o.shape,t)}},{key:"setBodyMass",value:function(e,t){e.mass=t,e.updateMassProperties(),0===t?(e.velocity.set(0,0,0),e.angularVelocity.set(0,0,0),e.type=gt.uT.STATIC,e.autoSync=!1):(e.type=gt.uT.DYNAMIC,e.autoSync=!0)}},{key:"finalizeBodyCreation",value:function(e,t){var r=new gt.uT({mass:t,shape:e});return r.userData||(r.userData={}),r}},{key:"raycast",value:function(e,t){var r=[];return Jt.reset(),Ut.intersectWorld(this.engine,{from:new gt.AO(e.x,e.y,e.z),to:new gt.AO(t.x,t.y,t.z),mode:gt.zH.ALL,checkCollisionResponse:!1,skipBackfaces:!1,result:new gt.Fv,callback:function(e){r.push({body:e.body,position:e.hitPointWorld,normal:e.hitNormalWorld,distance:e.distance})}}),r}},{key:"wakeUpBody",value:function(e){e.wakeUp()}},{key:"startDebug",value:function(){this.debugRenderer=new kt.Z(this.scene,this.engine)}},{key:"sync",value:function(){var e,t=Et(this.engine.bodies);try{for(t.s();!(e=t.n()).done;){var r,n,o=e.value,i=null==o||null===(r=o.userData)||void 0===r?void 0:r.view;!(null==o||null===(n=o.userData)||void 0===n?void 0:n.skipSync)&&i&&i.parent&&(Xt.copy(o.position),i.parent.worldToLocal(Xt),i.position.copy(Xt),Kt.copy(o.quaternion),i.parent.getWorldQuaternion(Wt),Wt.invert(),i.quaternion.multiplyQuaternions(Wt,Kt))}}catch(e){t.e(e)}finally{t.f()}}},{key:"updateCollisions",value:function(){for(var e=[],t=0;t<this.engine.contacts.length;t++){var r,n=this.engine.contacts[t].bi,o=this.engine.contacts[t].bj,i=!1,a=Et(this.contacts);try{for(a.s();!(r=a.n()).done;){var s=r.value;if(s.body0.id===n.id&&s.body1.id===o.id){i=!0;break}if(s.body0.id===o.id&&s.body1.id===n.id){i=!0;break}}}catch(e){a.e(e)}finally{a.f()}i||(this.dispatchEvent({type:"collisionStart",bodyA:n,bodyB:o}),this.contacts.push({body0:n,body1:o})),e.push({body0:n,body1:o})}var u,l=[],c=Et(this.contacts);try{for(c.s();!(u=c.n()).done;){var f,h=u.value,y=!1,p=Et(e);try{for(p.s();!(f=p.n()).done;){var v=f.value;if(h.body0.id===v.body0.id&&h.body1.id===v.body1.id){y=!0;break}if(h.body0.id===v.body1.id&&h.body1.id===v.body0.id){y=!0;break}}}catch(e){p.e(e)}finally{p.f()}y||(this.dispatchEvent({type:"collisionEnd",bodyA:h.body0,bodyB:h.body1}),l.push(h))}}catch(e){c.e(e)}finally{c.f()}for(var d=0,b=l;d<b.length;d++){var m=b[d];this.contacts.splice(this.contacts.indexOf(m),1)}}},{key:"tick",value:function(e){for(this.engine.step(1/60,e/1e3,10);this.bodiesToRemove.length>0;)this.engine.removeBody(this.bodiesToRemove.shift());this.bodiesToRemove.length=0,this.debugRenderer&&this.debugRenderer.update(),this.updateCollisions(),this.sync()}}],n=[{key:"init",value:function(){}}],r&&Lt(t.prototype,r),n&&Lt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(Dt);const $t=Yt;var er=r(1250),tr=r(6150);function rr(e){return rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rr(e)}function nr(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function or(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yr(n.key),n)}}function ir(e,t,r){return t&&or(e.prototype,t),r&&or(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ar(e,t){return ar=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ar(e,t)}function sr(e){var t=cr();return function(){var r,n=fr(e);if(t){var o=fr(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ur(this,r)}}function ur(e,t){if(t&&("object"==rr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return lr(e)}function lr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(cr=function(){return!!e})()}function fr(e){return fr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},fr(e)}function hr(e,t,r){return(t=yr(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yr(e){var t=function(e,t){if("object"!=rr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=rr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==rr(t)?t:t+""}new n.Vector3(0,1,0);var pr=new n.Vector3(1e4,1e4,1e4),vr=new n.BoxGeometry(3,4,2),dr=new n.MeshBasicMaterial({color:16711680,visible:er.c.enabled,wireframe:!0}),br=.008,mr=.9,wr=(new n.Vector3,function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ar(e,t)}(a,e);var t,r,i=sr(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),hr(lr(t=i.call(this)),"isTrail",!0),hr(lr(t),"level",void 0),hr(lr(t),"view",void 0),hr(lr(t),"sheaf",void 0),hr(lr(t),"sheaf2",void 0),hr(lr(t),"collider",void 0),hr(lr(t),"body",void 0),hr(lr(t),"harvester",void 0),hr(lr(t),"cropType",""),hr(lr(t),"trailIndex",0),hr(lr(t),"truckLength",3.5),hr(lr(t),"scaleDuration",500),hr(lr(t),"_plantMeshes",new Map),hr(lr(t),"_sheafMaterial",void 0),hr(lr(t),"_cartMaterial",void 0),hr(lr(t),"_x2",!1),t.position.copy(pr),t.level=e,t.renderOrder=1e3,t}return ir(a,[{key:"x2",get:function(){return this._x2},set:function(e){this._x2=!!e,this.secondFloor.visible=this._x2,this.sheaf2&&(this.sheaf2.visible=this._x2)}},{key:"cage",get:function(){var e;return null===(e=this.view)||void 0===e?void 0:e.getObjectByName("Veh_Attach_Trailer_Cage")}},{key:"secondFloor",get:function(){var e;return null===(e=this.view)||void 0===e?void 0:e.getObjectByName("Veh_Attach_Trailer_Cage_SecondFloor")}}]),ir(a,[{key:"init",value:function(){this.view=s.PD("harvesters/trailer"),this.view.rotation.y=0,this.view.scale.setScalar(0),this.view.position.z=2,this.add(this.view),this.x2=!1,this.collider=new n.Mesh(vr,dr),this.collider.isDangerous=!0,this.add(this.collider);var e=s.Hp("textures/farm-combine"),t=new n.MeshPhongMaterial({map:e,side:n.DoubleSide});this._cartMaterial=t.clone(),this._sheafMaterial=t.clone(),this.view.traverse((function(e){e.isMesh&&(e.material=t)})),this.cage.material=this._cartMaterial,this.secondFloor.material=this._cartMaterial,this.computeBoundsTree(),this.addShadows()}},{key:"createBody",value:function(){this.body||(this.body=this.level.world.createCubeBody(1,new n.Vector3(4,4,2)),this.body.type=Qt.KINEMATIC,this.body.collisionFilterGroup=J,this.body.collisionFilterMask=U,this.body.userData.view=this,this.body.userData.skipSync=!0,this.level.world.addBody(this.body),this._syncBody())}},{key:"removeBody",value:function(){this.body&&(this.level.world.removeBody(this.body),this.body=null)}},{key:"addShadows",value:function(){this.allMeshObj=[],tr.Z.findMesh(this,this.allMeshObj),tr.Z.addShadows(this.allMeshObj,!0,!1)}},{key:"removeShadows",value:function(){tr.Z.addShadows(this.allMeshObj,!1,!1)}},{key:"_createSheaf",value:function(e){var t=this;this.sheaf&&this.sheaf.removeFromParent(),this.sheaf2&&this.sheaf2.removeFromParent(),this.sheaf=s.PD("sheafs/".concat(e)),this.sheaf.position.set(0,300,-300),this.sheaf.scale.setScalar(mr),this.sheaf.traverse((function(e){e.isMesh&&(e.material=t._sheafMaterial)})),this.view.add(this.sheaf),this.sheaf.computeBoundsTree(),this.sheaf2=this.sheaf.clone(),this.sheaf2.position.y+=300,this.sheaf2.visible=this.x2,this.view.add(this.sheaf2)}},{key:"setPos",value:function(e){this.position.copy(e),this.position.y=0}},{key:"setForward",value:function(e){(e=e.clone()).y=0,this.lookAt(this.position.clone().add(e)),this.up.set(0,1,0)}},{key:"setHarvestType",value:function(e){this.cropType=e,this._createSheaf(e)}},{key:"setColor",value:function(e){this._cartMaterial.color.setHex(e)}},{key:"setHarvester",value:function(e){this.harvester=e}},{key:"setTrailIndex",value:function(e){this.trailIndex=e}},{key:"doPunchAnimation",value:function(e){if(this.view){this.view.scale.setScalar(br);var t=this.secondFloor.visible?this.secondFloor:this.view,r=this.secondFloor.visible?1:br;new o.kX(t.scale).delay(e).to({y:[2*r,r]},500).start()}}},{key:"doScaleAnim",value:function(){this.view&&(this.view.scale.setScalar(0),new o.kX(this.view.scale).to({x:br,y:br,z:br},this.scaleDuration).start())}},{key:"doX2UpAnimation",value:function(){this.secondFloor.scale.y=0,new o.kX(this.secondFloor.scale).to({y:1},1500).easing(o.oY.Bounce.Out).start(),this.sheaf2&&(this.sheaf2.scale.setScalar(0),new o.kX(this.sheaf2.scale).delay(300).to({x:mr,y:mr,z:mr},1e3).easing(o.oY.Bounce.Out).start()),this._runX2SphereVFX(),this._runX2BlinkVFX()}},{key:"_runX2SphereVFX",value:function(){for(var e=this,t=[s.Hp("textures/vfx/txt-farmer-1"),s.Hp("textures/vfx/txt-farmer-2")],r=2e3,i=function(i){var a=t[~~(t.length*Math.random())],s=new n.MeshBasicMaterial({map:a,transparent:!0,opacity:1,color:16776960}),u=new n.Mesh(new n.SphereGeometry(4+.5*i,32,32),s);u.rotation.y=2*Math.PI*Math.random(),e.add(u),new o.kX(s).to({opacity:0},1e3).delay(900).start(),new o.kX(u.rotation).to({y:4*Math.PI+8*Math.PI*Math.random()},r).easing(o.oY.Quadratic.InOut).onComplete((function(){return u.removeFromParent()})).start()},a=0;a<4;a++)i(a)}},{key:"_runX2BlinkVFX",value:function(){var e=this,t=16776960,r=new n.MeshPhongMaterial({color:t,emissive:t,reflectivity:1,specular:t,shininess:30});new o.kX({value:0}).repeat(5).yoyo(!0).to({value:1},250).onUpdate((function(t,n){t.value>.5?(e.cage.material=[e._cartMaterial,r],e.secondFloor.material=[e._cartMaterial,r]):(e.cage.material=e._cartMaterial,e.secondFloor.material=e._cartMaterial)})).onComplete((function(){e.cage.material=e._cartMaterial,e.secondFloor.material=e._cartMaterial})).start()}},{key:"doX2DownAnimation",value:(t=regeneratorRuntime.mark((function e(){var t,r=this,n=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:0,e.abrupt("return",new Promise((function(e){new o.kX(r.sheaf.scale).to({x:0,y:0,z:0},300).delay(t).easing(o.oY.Quadratic.In).start(),new o.kX(r.position).to({y:-3},500).delay(t).easing(o.oY.Bounce.Out).onComplete((function(){return e(r)})).start()})));case 2:case"end":return e.stop()}}),e)})),r=function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(e){nr(i,n,o,a,s,"next",e)}function s(e){nr(i,n,o,a,s,"throw",e)}a(void 0)}))},function(){return r.apply(this,arguments)})},{key:"explode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.dropHarvest(e)}},{key:"dropHarvest",value:function(e){if(this.cropType&&!(e<=0)){this.position.clone(),this.quaternion.clone();this.setHarvestType("")}}},{key:"handleDestroy",value:function(){this.parent&&this.parent.remove(this),this.body&&(this.body.userData.view=null,this.level.world.removeBody(this.body)),this.body=null,this.clear(),this.collider=null,this.level=null}},{key:"_syncBody",value:function(){this.body&&(this.level.world.setBodyPosition(this.body,this.position),this.level.world.setBodyQuaternion(this.body,this.quaternion))}},{key:"tick",value:function(e){this._syncBody()}}]),a}(n.Group)),gr=r(3446),kr=r(8834),Pr=r(9751),Sr=r(3494),Or=r(1497);r(4233);function jr(e){return jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jr(e)}function xr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||Lr(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _r(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function Tr(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){_r(i,n,o,a,s,"next",e)}function s(e){_r(i,n,o,a,s,"throw",e)}a(void 0)}))}}function Br(e,t){return Br=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Br(e,t)}function Cr(e){var t=Dr();return function(){var r,n=Rr(e);if(t){var o=Rr(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Ar(this,r)}}function Ar(e,t){if(t&&("object"==jr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Mr(e)}function Mr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Dr=function(){return!!e})()}function Rr(e){return Rr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Rr(e)}function Er(e){return function(e){if(Array.isArray(e))return Fr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Lr(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ir(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Lr(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function Lr(e,t){if(e){if("string"==typeof e)return Fr(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Fr(e,t):void 0}}function Fr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function zr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Nr(n.key),n)}}function Vr(e,t,r){return t&&Gr(e.prototype,t),r&&Gr(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Zr(e,t,r){return(t=Nr(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Nr(e){var t=function(e,t){if("object"!=jr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=jr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==jr(t)?t:t+""}var Hr=_.ai,Xr=new n.Euler,Kr=new n.Quaternion,Wr=new n.Vector3,Ur=Math.PI,Jr=2*Ur,qr=new n.Raycaster(new n.Vector3,new n.Vector3,0,5),Qr=new n.MeshBasicMaterial({color:16711680}),Yr=function(){function e(){zr(this,e),Zr(this,"node",void 0)}return Vr(e,[{key:"createNode",value:function(){return this.node||(this.node=document.body.appendChild(document.createElement("pre")),this.node.id="actor-harvest-debug",Object.assign(this.node.style,{position:"fixed",zIndex:100500,left:"1em",bottom:"1em",padding:"4px",background:"rgba(255, 255, 255, 0.5)",pointerEvents:"none"})),this.node}},{key:"_formatPlant",value:function(e,t){var r=e.gatheredCrops.get(t.type)||0,n=e.trails.filter((function(e){return e.cropType===t.type})).length,o="".concat(t.type,":").padEnd(10," ");return"".concat(o," ").concat(r," + ").concat(n,"x").concat(t.plantCost)}},{key:"update",value:function(e){var t=this;if(er.c.enabled){this.createNode();var r=new Map;if(e.level){var n,o=Ir(e.level.fields);try{for(o.s();!(n=o.n()).done;){var i=n.value;r.set(i.plant,i.plantData)}}catch(e){o.e(e)}finally{o.f()}}var a="";a+="<b>HARVEST STATS</b>\nTruck size: ".concat(e.amountPerTruck,"\nHarvested:  ").concat(e.totalHarvested," (~").concat((e.totalHarvested/e.amountPerTruck).toFixed(1),")\nTrail size: ").concat(~~e.trails.length,"\n\n<b>PLANT STATS</b>\n").concat(Er(r.values()).map((function(r){return t._formatPlant(e,r)})).join("\n"),"\n\n<b>LEVEL STATS</b>\nLevel: ").concat(e.harvLevel,"\nProgress: ").concat(e.levelProgress<0?"X":e.levelProgress.toFixed(2)," (").concat(e.levelGoals.map((function(e){return e.toFixed(2)})).join("-"),")\n"),this.node.innerHTML=a,r.clear()}}},{key:"destroy",value:function(){this.node&&this.node.parentNode&&this.node.parentNode.removeChild(this.node),this.node=null}}]),e}(),$r=K|W|U|J,en=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Br(e,t)}(h,e);var t,r,u,l,c,f=Cr(h);function h(e,t){var r;return zr(this,h),Zr(Mr(r=f.call(this)),"__harvestDebug",void 0),Zr(Mr(r),"skin",1),Zr(Mr(r),"color",1),Zr(Mr(r),"level",1),Zr(Mr(r),"isBot",null),Zr(Mr(r),"isDead",!1),Zr(Mr(r),"wasRevived",!1),Zr(Mr(r),"startBigger",!1),Zr(Mr(r),"isInvulnerable",!1),Zr(Mr(r),"invulnerableTimeout",0),Zr(Mr(r),"spawnPosition",new n.Vector3(0,0,0)),Zr(Mr(r),"_speed",_.d9.speed),Zr(Mr(r),"speedMultiplier",1),Zr(Mr(r),"nearWalls",new j.CloseWalls),Zr(Mr(r),"behaviours",[]),Zr(Mr(r),"maxLevel",_.gL.Qq||4),Zr(Mr(r),"harvLevel",1),Zr(Mr(r),"levelThresholds",Er(_.gL.rl)),Zr(Mr(r),"overrideReelLevel",-1),Zr(Mr(r),"levelGoals",[0,1]),Zr(Mr(r),"initialAmountPerTruck",_.gL.HJ),Zr(Mr(r),"amountPerTruckMultiplier",1),Zr(Mr(r),"totalKills",0),Zr(Mr(r),"totalHarvested",0),Zr(Mr(r),"gatheredCrops",new Map),Zr(Mr(r),"useReviveForwardForChain",!1),Zr(Mr(r),"lastReviveDirection",new n.Vector3),Zr(Mr(r),"firstTrailOffset",.5),Zr(Mr(r),"trailEndPredictionDist",4.5),Zr(Mr(r),"extraTrailLength",3.5),Zr(Mr(r),"trails",[]),Zr(Mr(r),"truckChain",new wt),Zr(Mr(r),"truckLengths",[]),Zr(Mr(r),"chainPoints",[]),Zr(Mr(r),"leftOverSheafSpreadDistance",_.gL.bD),Zr(Mr(r),"harvestShapes",new Map),Zr(Mr(r),"reviveInvincibilityDuration",2e3),Zr(Mr(r),"boosters",[]),Zr(Mr(r),"usedBoosterOnce",!1),Zr(Mr(r),"hasSaw",!1),Zr(Mr(r),"soundTimer",300),Zr(Mr(r),"soundMackStart",!1),Zr(Mr(r),"directionArrow",null),Zr(Mr(r),"_wallRaycastTimeout",0),Zr(Mr(r),"destroyAnimationGroup",null),r.renderOrder=1001,r.level=t,r.skin=e.skin,r.color=e.color,r.isBot=e.isBot,r.startBigger=!!e.startBigger,r.isActor=!0,r.harvestShapes.set("reel",new a.mg([new a.E9,new a.E9,new a.E9,new a.E9])),r.wallPlane=new n.Plane,r.isBot&&(r._speed=Hr.speed.min+Math.random()*(Hr.speed.max-Hr.speed.min)),r.isBot?(r.behaviours.push(new Ee(Mr(r))),r.behaviours.push(new qe(Mr(r))),r.behaviours.push(new ft(Mr(r))),r.behaviours.push(new Pe(Mr(r)))):r.__harvestDebug=new Yr(Mr(r)),r}return Vr(h,[{key:"harvesterLength",get:function(){return 3}},{key:"truckLength",get:function(){var e;return(null===(e=this.trails[0])||void 0===e?void 0:e.truckLength)||0}},{key:"amountPerTruck",get:function(){return this.initialAmountPerTruck*this.amountPerTruckMultiplier}},{key:"speed",get:function(){return this._speed*this.speedMultiplier}},{key:"currentDirection",get:function(){var e;return((null===(e=this.steerer)||void 0===e?void 0:e.course)||0)%(2*Math.PI)}},{key:"harvestProgress",get:function(){return this.level?this.totalHarvested/this.level.totalCrops:0}},{key:"canLevelUp",get:function(){return this.harvLevel<this.maxLevel}},{key:"levelProgress",get:function(){if(!this.canLevelUp)return 1;var e=this.harvestProgress-this.levelGoals[0],t=this.levelGoals[1]-this.levelGoals[0];return Math.max(0,Math.min(1,e/t))}},{key:"harvestPoints",get:function(){return this.view.harvestPoints}},{key:"harvestRect",get:function(){var e=this.harvestPoints,t=this.harvestShapes.get("reel");t.points.length=0;var r,n=Ir(e);try{for(n.s();!(r=n.n()).done;){var o=r.value;t.points.push(o.x,o.z)}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"forward",get:function(){return Wr.clone().set(0,0,1).applyQuaternion(this.quaternion).normalize()}}]),Vr(h,[{key:"preload",value:(c=Tr(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[],r=1;r<=10;r++)for(n=1;n<=6;n++)t.push("harvesters/skins/Veh_Harvester".concat(r,"_a").concat(n));return e.abrupt("return",Promise.all([s.yG("textures/farm-simple"),s.yG("textures/farm-combine"),s.u7("arrow")].concat(Er(t.map((function(e){return s.u7(e)}))),[s.yG("textures/vfx/txt-farmer-1"),s.yG("textures/vfx/txt-farmer-2")])));case 3:case"end":return e.stop()}}),e)}))),function(){return c.apply(this,arguments)})},{key:"setSkin",value:(l=Tr(regeneratorRuntime.mark((function e(){var t,r,n,o,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:this.skin,r=i.length>1&&void 0!==i[1]?i[1]:this.color,this.view||(this.view=new gr.Y(t,r),this.add(this.view)),e.next=5,this.view.init(t,r);case 5:this.startBigger&&this.setHarvesterLevel(this.maxLevel,!0),this.view.playerCar=!this.isBot,this.view.runHarvestAnimations(),n=Ir(this.trails);try{for(n.s();!(o=n.n()).done;)o.value.setColor(this.view.hexColor)}catch(e){n.e(e)}finally{n.f()}return this.skin=t,this.color=r,e.next=14,this.initDestroyAnimation();case 14:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"init",value:(u=Tr(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.preload();case 2:return this.levelThresholds=Er(_.gL.rl),this.initialAmountPerTruck=_.gL.HJ,e.next=6,this.setSkin(this.skin,this.color);case 6:this.initDirectionArrow(),this.collider=new n.Mesh(new n.BoxGeometry(8,10,11),new n.MeshBasicMaterial({color:16711680,visible:er.c.enabled,wireframe:!0})),this.collider.isDangerous=!0,this.add(this.collider),this.computeBoundsTree(),this.body=this.level.world.createSphereBody(1,3),this.body.collisionFilterGroup=U,this.body.collisionFilterMask=$r,this.level.world.addBody(this.body),this.body.userData.view=this,this.body.userData.skipSync=!0,this.steerer=new X,this.steerer.harvester=this,this.steerer.run(),this.steerer.setCourse(0,!0),this.setPosition(this.spawnPosition),this.setHarvesterLevel(this.startBigger?this.maxLevel:1,!0),this.isBot&&er.c.enabled&&this.drawBotDebug();case 24:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"initDirectionArrow",value:function(){!this.isBot&&this.level&&(this.directionArrow=s.PD("arrow"),this.directionArrow.scale.setScalar(.01),this.directionArrow.traverse((function(e){e.material&&(e.material=Qr)})),this.toggleDirectionArrow(!1),this.level.add(this.directionArrow))}},{key:"drawViewSector",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:65280,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;e=n.MathUtils.degToRad(e)/2;var i=new n.Shape;i.moveTo(0,0),i.lineTo(Math.cos(-e)*t,Math.sin(-e)*t),i.absarc(0,0,t,-e,e,!1),i.lineTo(0,0);var a=new n.ExtrudeGeometry(i,{curveSegments:10,depth:.1,bevelEnabled:!1}),s=new n.Mesh(a,new n.MeshStandardMaterial({color:r,transparent:!0,opacity:o}));s.rotation.x=Math.PI/2,s.rotation.z=Math.PI/2,this.add(s)}},{key:"drawBotDebug",value:function(){this.drawViewSector(Hr.danger.scanAngle,Hr.danger.scanDistance,16711680)}},{key:"setPosition",value:function(e,t,r){void 0===t&&(t=e.y,r=e.z,e=e.x),this.position.set(e,t+2,r),this.level.world&&this.body&&this.level.world.setBodyPosition(this.body,this.position),this.position.set(e,t,r)}},{key:"setQuaternion",value:function(e,t,r,n){void 0===t&&(t=e.y,r=e.z,n=e.w,e=e.x),this.quaternion.set(e,t,r,n),this.level.world&&this.body&&this.level.world.setBodyQuaternion(this.body,this.quaternion)}},{key:"correctPositionByBody",value:function(){if(this.body){var e=this.level.world.getBodyPosition(this.body);this.position.set(e.x,0,e.z);var t=this.level.world.getBodyQuaternion(this.body);this.quaternion.set(t.x,t.y,t.z,t.w),this.level.world.setBodyVelocity(this.body,Wr.set(0,0,0)),this.level.world.setBodyAngularVelocity(this.body,Wr.set(0,0,0))}}},{key:"getDangerousColliders",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.collider&&e.push(this.collider);var t,r=Ir(this.trails);try{for(r.s();!(t=r.n()).done;){var n=t.value;n.collider&&e.push(n.collider)}}catch(e){r.e(e)}finally{r.f()}return e}},{key:"handleDestroy",value:function(){this.body&&(this.body.userData.view=null,this.level.world.removeBody(this.body)),this.body=null,this.directionArrow&&(this.directionArrow.removeFromParent(),this.directionArrow=null),this.__harvestDebug&&(this.__harvestDebug.destroy(),this.__harvestDebug=null),this.view.stopSound(),this.view.soundOff=!0,this.harvestShapes.clear(),this.view.destroy()}},{key:"collectSheaf",value:function(e){this.gatherHarvestable(e.cropType,e.dropValue)}},{key:"calculateHarvestedResult",value:function(){var e,t=new Map,r=this.amountPerTruckMultiplier,n=Ir(this.trails);try{for(n.s();!(e=n.n()).done;){var o=e.value,i=~~t.get(o.cropType)+r;t.set(o.cropType,i)}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"turnTo",value:function(e){for(;e>Jr;)e-=Jr;for(;e<0;)e+=Jr;this.steerer.setCourse(e)}},{key:"updateCloseWalls",value:function(){if(this.level&&this.level.world){var e=this.level.colliders;if(e&&e.length){qr.far=5,qr.set(this.position.clone(),new n.Vector3(0,0,1)),this.nearWalls.BackwardWall=qr.intersectObjects(e).shift(),qr.set(this.position.clone(),new n.Vector3(0,0,-1)),this.nearWalls.ForwardWall=qr.intersectObjects(e).shift(),qr.set(this.position.clone(),new n.Vector3(1,0,0)),this.nearWalls.RightWall=qr.intersectObjects(e).shift(),qr.set(this.position.clone(),new n.Vector3(-1,0,0)),this.nearWalls.LeftWall=qr.intersectObjects(e).shift();[this.nearWalls.BackwardWall?"B":"-",this.nearWalls.RightWall?"R":"-",this.nearWalls.ForwardWall?"T":"-",this.nearWalls.LeftWall?"L":"-"].join("");var t=this.forward;qr.set(this.position.clone(),t.clone()),qr.far=12;var r=qr.intersectObjects(e).shift(),o=void 0;if(r&&this._wallRaycastTimeout<=0){r.distance;var i=r.point,a=r.normal;o=Math.round(this.steerer.getDirectionCourse(a.clone().negate())/(.5*Ur)),this.wallPlane.set(a,0);var s=this.wallPlane.projectPoint(t,new n.Vector3).normalize(),u=s.lengthSq();(0===u||1===u&&0===this.steerer.rawCourse)&&(Wr.set(0,1,0).cross(t),s.copy(t).cross(Wr)),qr.set(i.clone(),s.clone()),qr.far=5;var l=qr.intersectObjects(e).shift();if(l&&!l.normal.equals(a))o!==Math.round(this.steerer.getDirectionCourse(l.normal.clone().negate())/(.5*Ur))&&s.negate();var c=this.steerer.getDirectionCourse(s);this.steerer.setCourse(c),this._wallRaycastTimeout=500}}}}},{key:"gatherHarvestable",value:function(e,t){this.totalHarvested+=t;var r=~~this.gatheredCrops.get(e)||0;r+=t;for(var n=this.amountPerTruck;r>=n;)r-=n,this.spawnTrail(e);this.playCutSounds(e),this.gatheredCrops.set(e,r)}},{key:"spawnTrail",value:function(e){if(!this.isDead){var t=new wr(this.level);t.init(),t.createBody(),this.trails.push(t),t.x2=this.amountPerTruckMultiplier>1,this.level.add(t),t.setHarvestType(e),t.setColor(this.view.hexColor),t.setHarvester(this);for(var r=this.trails.length-1;r>=1;--r)this.trails[r].setHarvestType(this.trails[r-1].cropType),this.trails[r].setTrailIndex(r);var n=this.trails[0];n.setHarvestType(e),n.setTrailIndex(0),this.onTrailSpawned()}}},{key:"playCutSounds",value:function(e){if(!this.isDead&&!this.isBot&&!Or.Z.isLocked&&this.soundMackStart){this.soundMackStart=!1;var t=.1;switch(e){case"rocket":Or.Z.play("candy-3");break;case"cookie":Or.Z.play("candy-4",!1,t);break;case"candy":Or.Z.play("candy-6",!1,t);break;case"lollipop":Math.random()>.5?Or.Z.play("candy-7b",!1,t):Or.Z.play("candy-8",!1,t);break;default:Or.Z.play("cut-3",!1,.05)}}}},{key:"cutTrailFromIndex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.trails.length;if(!(e>=t))for(var r=this.trails.length-1;r>=e;r--){var n=this.trails[r],o=n.cropType,i=this.level.spawnSheaf(o,this.amountPerTruck);i.updateTransformFromObject(n),n.handleDestroy(),this.totalHarvested=Math.max(0,this.totalHarvested-this.amountPerTruck),this.trails.splice(r,1)}}},{key:"trimTrailToExact",value:function(){var e,t=0,r=Ir(this.truckLengths);try{for(r.s();!(e=r.n()).done;){t+=e.value}}catch(e){r.e(e)}finally{r.f()}this.truckChain.trimToLength(t)}},{key:"onTrailSpawned",value:function(){for(var e=0,t=Math.min(5,this.trails.length-1),r=0;r<t;r++)this.trails[r].doPunchAnimation(e),e+=100;this.trails[this.trails.length-1].doScaleAnim()}},{key:"explodeCarts",value:function(){this.spawnLeftOverResources(),this.cutTrailFromIndex(0),this.clearGatheredCrops()}},{key:"clearGatheredCrops",value:function(){this.gatheredCrops.clear()}},{key:"spawnLeftOverResources",value:function(){var e,t=new n.Vector3,r=new n.Quaternion,o=new n.Vector3(0,1,0),i=Ir(this.gatheredCrops);try{for(i.s();!(e=i.n()).done;){var a=xr(e.value,2),s=a[0],u=a[1];if(!(u<=0)){t.randomDirection(),t.y=0,t.normalize().multiplyScalar(this.leftOverSheafSpreadDistance*Math.random());var l={position:t.add(this.position),quaternion:r.setFromAxisAngle(o,Jr*Math.random())};this.level.spawnSheaf(s,u).updateTransformFromObject(l),this.totalHarvested-=u,this.totalHarvested=Math.max(0,this.totalHarvested)}}}catch(e){i.e(e)}finally{i.f()}}},{key:"updateTrucks",value:function(){if(this.truckChain.addNextPoint(this.view.hookPosition),!(this.trails.length<=0)){this.truckLengths.splice(0),this.truckLengths.push(this.firstTrailOffset);var e,t=Ir(this.trails);try{for(t.s();!(e=t.n()).done;){var r=e.value;this.truckLengths.push(r.truckLength)}}catch(e){t.e(e)}finally{t.f()}var n=this.trails[0].truckLength;this.truckLengths.push(n),this.truckLengths.push(n),this.chainPoints=this.truckChain.getTruckPositions(this.truckLengths,this.chainPoints),this.chainPoints.length>0&&this.doChainUpdate()}}},{key:"doChainUpdate",value:function(){this.lastReviveDirection.lengthSq();var e=this.trails[0],t=Math.min(2,this.chainPoints.length-1),r=this.position.clone().sub(this.chainPoints[t]).normalize();e.setPos(this.chainPoints[0]),e.setForward(r);for(var n=1,o=1;o<this.trails.length&&o<this.chainPoints.length-1;o++)e=this.trails[o],r=Wr.subVectors(this.chainPoints[o],this.chainPoints[o+1]).normalize(),e.setPos(this.chainPoints[o]),e.setForward(r),n++;if(n<this.trails.length&&n<this.chainPoints.length){e=this.trails[n];var i=this.chainPoints[n].clone(),a=this.chainPoints[n-1],s=Wr.subVectors(i,a).normalize().multiplyScalar(this.trailEndPredictionDist).clone(),u=Wr.addVectors(i,s);this.useReviveForwardForChain?r.copy(this.lastReviveDirection):r.subVectors(i,u),e.setPos(i),e.setForward(r),n++}for(var l=this.truckChain.points[0],c=e.position.clone(),f=this.useReviveForwardForChain?this.lastReviveDirection.clone():Wr.subVectors(c,l).clone(),h=n;h<this.trails.length;h++)(e=this.trails[h]).setPos(l),e.setForward(f);n>=this.trails.length&&(this.useReviveForwardForChain=!1);var y,p=this.extraTrailLength,v=Ir(this.truckLengths);try{for(v.s();!(y=v.n()).done;){p+=y.value}}catch(e){v.e(e)}finally{v.f()}this.truckChain.trimToLength(p)}},{key:"explode",value:function(){this.isDead||(this.isDead=!0,this.spawnLeftOverResources(),this.cutTrailFromIndex(0),this.clearGatheredCrops())}},{key:"checkWhoWillDie",value:function(e){if(this.hasSaw^e.hasSaw)return this.hasSaw?e:this;var t=this.forward,r=e.forward,n=t.angleTo(r);if(n>.75*Math.PI&&n<=Math.PI){if(!this.isBot)return;return e.totalKills++,this}if(!this.isBot&&Math.abs(t.dot(r))>=.9)return this.totalKills++,e;var o=e.position.clone().sub(this.position);return t.dot(o)>0?(e.totalKills++,this):void 0}},{key:"updateTimers",value:function(e){this.invulnerableTimeout>0&&(this.invulnerableTimeout-=e,this.invulnerableTimeout<=0&&this.setInvulnerable(!1))}},{key:"setInvulnerable",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;this.isInvulnerable=!!e,this.invulnerableTimeout=e?Math.max(0,t):0,e&&!this.hasSaw?this.body.collisionFilterMask=W:this.body.collisionFilterMask=$r}},{key:"updateLevelGoals",value:function(){this.levelGoals.splice(0),this.harvLevel<this.maxLevel&&this.levelGoals.push(this.levelThresholds[this.harvLevel-2]||0,this.levelThresholds[this.harvLevel-1]||1)}},{key:"setHarvesterLevel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isDead||(e=Math.max(1,Math.min(this.maxLevel,~~e)))<=this.harvLevel&&!t||(kr.X.emit("actorLevelUp",{newLevel:e,actor:this}),this.harvLevel=e,this.updateLevelGoals(e),-1===this.overrideReelLevel&&this.setReel(this.harvLevel,t))}},{key:"setReel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.harvLevel,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=-1!==this.overrideReelLevel?this.overrideReelLevel:e;this.view.reel.setLevel(r,t)}},{key:"checkLevelUp",value:function(){this.canLevelUp&&(this.harvestProgress<(this.levelGoals[1]||1)||(this.setHarvesterLevel(this.harvLevel+1),kr.X.emit("actorLevelUp",{actor:this})))}},{key:"initDestroyAnimation",value:(r=Tr(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.Z.createScene("boomHarvester");case 2:return this.destroyAnimationGroup=e.sent,this.destroyAnimationGroup.position.z=-2,this.destroyAnimationGroup.visible=!1,this.destroyAnimationGroup.children[0].visible=!1,this.destroyAnimationGroup.children[2].children[0].system.behaviour[0].color.from=["#"+this.view.hexColor.toString(16)],this.destroyAnimationGroup.children[1].visible=!1,e.abrupt("return",this.destroyAnimationGroup);case 9:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"showDestroyAnimation",value:(t=Tr(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.cutTrailFromIndex(),!(this.destroyAnimationGroup instanceof Promise)){e.next=6;break}return console.log("DESTROY ANIMATION WAIT"),e.next=5,this.destroyAnimationGroup;case 5:this.destroyAnimationGroup=e.sent;case 6:if(this.destroyAnimationGroup){e.next=11;break}return console.log("DESTROY ANIMATION RECREATE"),e.next=10,this.initDestroyAnimation();case 10:this.destroyAnimationGroup=e.sent;case 11:return e.abrupt("return",new Promise((function(e){t.add(t.destroyAnimationGroup),t.destroyAnimationGroup.visible=!0;var r=xr(t.destroyAnimationGroup.children[1].children,5),n=(r[0],r[1],r[2],r[3],r[4],xr(t.destroyAnimationGroup.children[2].children,2)),i=(n[0],n[1]),a=xr(t.destroyAnimationGroup.children[3].children,4),s=a[0],u=a[1],l=a[2],c=a[3];i.system.behaviour.splice(1,1);var f=new Pr.Z(i.system);f.position.set(0,3,0),t.add(f);var h=100;new o.kX(s).to({position:{x:-6,y:.5},rotation:{x:.5*Math.PI,y:.5*Math.PI}},800).easing(o.ZP.Easing.Cubic.Out).delay(h).start(),new o.kX(u).to({position:{x:5,y:.5},rotation:{x:1.5*Math.PI,y:.5*Math.PI}},1150).easing(o.ZP.Easing.Cubic.Out).delay(h).start(),new o.kX(l).to({position:{x:-8,y:.5},rotation:{x:1.5*Math.PI,y:.5*Math.PI}},1300).easing(o.ZP.Easing.Cubic.Out).delay(h).start(),new o.kX(c).to({position:{x:3,y:.5},rotation:{x:.5*Math.PI,y:.5*Math.PI}},900).easing(o.ZP.Easing.Cubic.Out).delay(h).start(),new o.kX(t.destroyAnimationGroup.position).to({y:-2},500).delay(900).start(),new o.kX(t.view.scale).to({x:0,y:0,z:0},500).start(),new Sr.Z(1500).once("finish",(function(){e(),t.destroyAnimationGroup.removeFromParent(),t.destroyAnimationGroup=null,t.cutTrailFromIndex(),t.destroyAnimationGroup=t.initDestroyAnimation(),f.emitter.stopEmit(),f.emitter.destroy(),t.remove(f)}))})));case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"toggleDirectionArrow",value:function(e){this.directionArrow&&(this.directionArrow.visible=!!e,(this.directionArrow.children[0].castShadow||this.directionArrow.children[0].receiveShadow)&&(this.directionArrow.children[0].castShadow=!1,this.directionArrow.children[0].receiveShadow=!1))}},{key:"_updateDirectionArrow",value:function(){this.directionArrow&&(Wr.copy(this.steerer.getTargetForward(this.view.directionArrowOffset||15)).add(this.position),Wr.y+=_.d9.directionArrowHeight||3,this.directionArrow.position.lerp(Wr,.1),Kr.setFromEuler(Xr.set(0,this.steerer.targetCourse,0)),this.directionArrow.quaternion.slerp(Kr,.1))}},{key:"hideTrail",value:function(){var e,t=Ir(this.trails);try{for(t.s();!(e=t.n()).done;){e.value.visible=!1}}catch(e){t.e(e)}finally{t.f()}}},{key:"enableTrail",value:function(){var e,t=Ir(this.trails);try{for(t.s();!(e=t.n()).done;){e.value.visible=!0}}catch(e){t.e(e)}finally{t.f()}}},{key:"repositionAfterRevive",value:function(){this.useReviveForwardForChain=!0,this.lastReviveDirection.copy(this.forward),this.lastReviveDirection.y=0,this.lastReviveDirection.normalize()}},{key:"insertReviveChainPoints",value:function(){var e=this.view.hookPosition;this.truckChain.addNextPoint(e),this.truckChain.addNextPoint(Wr.subVectors(e,this.forward.negate().multiplyScalar(.1)))}},{key:"showReviveInvincibilityAnimation",value:function(){var e=new n.MeshBasicMaterial({color:16777215,transparent:!0,opacity:.5}),t=[],r=function(e){e.material&&t.push(e)};this.view.traverse(r),this.view.reel.view.traverse(r);var i,a=Ir(this.trails);try{for(a.s();!(i=a.n()).done;){i.value.view.traverse(r)}}catch(e){a.e(e)}finally{a.f()}var s=t.map((function(e){return e.material})),u=function(r){for(var n=0;n<t.length;n++)t[n].material=r?e:s[n]};new o.ZP.Tween({value:1}).to({value:0},this.reviveInvincibilityDuration/9).yoyo(!0).repeat(9).onUpdate((function(e){u(e.value<.5)})).onComplete((function(){return u(!1)})).start()}},{key:"showDeathBlinkAnimation",value:function(){var e=[],t=function(t){t.material&&(t.material.transparent=!0,t.material.needsUpdate=!0,e.push(t.material))};this.view.view.traverse(t),this.view.reel.view.traverse(t);this.view.removeShadows();var r,n=Ir(this.trails);try{for(n.s();!(r=n.n()).done;){r.value.removeShadows()}}catch(e){n.e(e)}finally{n.f()}new o.kX({opacity:1}).to({opacity:0},200).onUpdate((function(t){for(var r=0,n=e;r<n.length;r++){var o=n[r];o.opacity=t.opacity,o.needsUpdate=!0}})).start()}},{key:"revive",value:function(e){var t=this;if(this.isDead){this.truckChain.clear(),this.hideTrail();var r,n=Ir(this.trails);try{for(n.s();!(r=n.n()).done;){r.value.removeBody()}}catch(e){n.e(e)}finally{n.f()}this.repositionAfterRevive(),this.insertReviveChainPoints(),this.updateTrucks(),this.wasRevived=!0,this.isDead=!1,this.enableTrail(),this.setInvulnerable(!0,this.reviveInvincibilityDuration),this.showReviveInvincibilityAnimation(),new Sr.Z(this.reviveInvincibilityDuration).once("finish",(function(){var e,r=Ir(t.trails);try{for(r.s();!(e=r.n()).done;){e.value.createBody()}}catch(e){r.e(e)}finally{r.f()}}))}}},{key:"_updateHarvestShapes",value:function(){var e=this.harvestPoints,t=this.harvestShapes.get("reel");t.points.length=0;var r,n=Ir(e);try{for(n.s();!(r=n.n()).done;){var o=r.value;t.points.push(o.x,o.z)}}catch(e){n.e(e)}finally{n.f()}}},{key:"isPointInHarvestArea",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;r&&this.level&&(Wr.set(e,0,t),r.localToWorld(Wr),this.level.worldToLocal(Wr),e=Wr.x,t=Wr.z);var n,o=Ir(this.harvestShapes.values());try{for(o.s();!(n=o.n()).done;){var i=n.value;if(i.contains(e,t))return!0}}catch(e){o.e(e)}finally{o.f()}return!1}},{key:"setSaw",value:function(e){this.hasSaw=!!e,this.view.reel.setSaw(!!e)}},{key:"tick",value:function(e){var t;if(this.steerer&&(this.updateTimers(e),0!==this.speed)){if(this.position.add(this.forward.multiplyScalar(this.speed*e/h.STATIC_DELTA)),this.position.y=0,this.setPosition(this.position),this.updateTrucks(),this._updateHarvestShapes(),this.steerer.updateCourse(e),n.MathUtils.setQuaternionFromProperEuler(this.quaternion,this.steerer.course,0,0,"YXY"),this.setQuaternion(this.quaternion),this._wallRaycastTimeout=this._wallRaycastTimeout>0?this._wallRaycastTimeout-e:0,this.updateCloseWalls(),this.behaviours.length){var r,o=Ir(this.behaviours);try{for(o.s();!(r=o.n()).done;){r.value.tick(e)}}catch(e){o.e(e)}finally{o.f()}}var i,a=Ir(this.trails);try{for(a.s();!(i=a.n()).done;){i.value.tick(e)}}catch(e){a.e(e)}finally{a.f()}this.checkLevelUp(),this._updateDirectionArrow(),null===(t=this.view)||void 0===t||t.tick(e),this.soundTimer>0?this.soundTimer-=e:this.soundTimer<=0&&(this.soundTimer=200,this.soundMackStart=!0)}}},{key:"postTick",value:function(){this.correctPositionByBody(),this.__harvestDebug&&this.__harvestDebug.update(this)}}]),h}(n.Group);Zr(en,"STATIC_DELTA",1e3/60);const tn=en;var rn=r(4803);const nn=JSON.parse('[{"type":"apricot","radius":0.79031384,"scale":0.01,"plantCost":34,"countX":18,"countZ":9,"theme":"default"},{"type":"banana","radius":1.0367973,"scale":0.01,"plantCost":34,"countX":18,"countZ":9,"theme":"default"},{"type":"beetle","radius":0.66,"scale":0.01,"plantCost":34,"countX":18,"countZ":9,"theme":"default"},{"type":"beetroot","radius":0.73,"scale":0.01,"plantCost":34,"countX":18,"countZ":9,"theme":"default"},{"type":"cabbage","radius":1.56,"scale":0.01,"plantCost":77,"countX":12,"countZ":6,"theme":"default"},{"type":"carrot","radius":0.38,"scale":0.01,"plantCost":34,"countX":18,"countZ":9,"theme":"default"},{"type":"cherry","radius":1.3431737,"scale":0.01,"plantCost":38,"countX":16,"countZ":9,"theme":"default"},{"type":"chilli","radius":0.67,"scale":0.01,"plantCost":34,"countX":18,"countZ":9,"theme":"default"},{"type":"corn","radius":0.75,"scale":0.01,"plantCost":8,"countX":36,"countZ":18,"theme":"default"},{"type":"cucumber","radius":1,"scale":0.01,"plantCost":57,"countX":16,"countZ":6,"theme":"default"},{"type":"eggplant","radius":0.8,"scale":0.01,"plantCost":43,"countX":16,"countZ":8,"theme":"default"},{"type":"lemon","radius":0.72,"scale":0.01,"plantCost":34,"countX":18,"countZ":9,"theme":"default"},{"type":"onion","radius":0.67,"scale":0.01,"plantCost":34,"countX":18,"countZ":9,"theme":"default"},{"type":"orange","radius":0.8103605,"scale":0.01,"plantCost":34,"countX":18,"countZ":9,"theme":"default"},{"type":"plum","radius":0.95192444,"scale":0.01,"plantCost":34,"countX":18,"countZ":9,"theme":"default"},{"type":"potato","radius":0.66,"scale":0.01,"plantCost":34,"countX":18,"countZ":9,"theme":"default"},{"type":"pumpkin","radius":1.3097558,"scale":0.01,"plantCost":34,"countX":18,"countZ":9,"theme":"default"},{"type":"purplewheat","radius":0.54,"scale":0.01,"plantCost":6,"countX":40,"countZ":20,"theme":"default"},{"type":"reeds","radius":0.62,"scale":0.01,"plantCost":16,"countX":26,"countZ":13,"theme":"default"},{"type":"strawberry","radius":0.9661563,"scale":0.01,"plantCost":34,"countX":18,"countZ":9,"theme":"default"},{"type":"sunflower","radius":0.51,"scale":0.01,"plantCost":8,"countX":36,"countZ":18,"theme":"default"},{"type":"tomator","radius":0.96186894,"scale":0.01,"plantCost":34,"countX":18,"countZ":9,"theme":"default"},{"type":"tomatoy","radius":0.96186894,"scale":0.01,"plantCost":34,"countX":18,"countZ":9,"theme":"default"},{"type":"watermelon","radius":0.98,"scale":0.01,"plantCost":56,"countX":14,"countZ":7,"theme":"default"},{"type":"wheat","radius":0.36,"scale":0.01,"plantCost":6,"countX":40,"countZ":20,"theme":"default"},{"type":"candy","radius":0.64275146,"scale":0.01,"plantCost":34,"countX":18,"countZ":9,"theme":"snow"},{"type":"cookie","radius":0.8419082,"scale":0.01,"plantCost":34,"countX":18,"countZ":9,"theme":"snow"},{"type":"gift","radius":1.8504778,"scale":0.01,"plantCost":66,"countX":14,"countZ":6,"theme":"snow"},{"type":"lollipop","radius":0.6387913,"scale":0.01,"plantCost":34,"countX":18,"countZ":9,"theme":"snow"},{"type":"rocket","radius":1.0003827,"scale":0.01,"plantCost":43,"countX":16,"countZ":8,"theme":"snow"},{"type":"snow1","radius":3.32,"scale":1,"plantCost":16,"countX":26,"countZ":13,"theme":"snow"}]');function on(e){return on="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},on(e)}function an(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return sn(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?sn(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function sn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function un(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ln(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wn(n.key),n)}}function fn(e,t,r){return t&&cn(e.prototype,t),r&&cn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function hn(e,t){return hn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},hn(e,t)}function yn(e){var t=dn();return function(){var r,n=bn(e);if(t){var o=bn(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return pn(this,r)}}function pn(e,t){if(t&&("object"==on(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return vn(e)}function vn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(dn=function(){return!!e})()}function bn(e){return bn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},bn(e)}function mn(e,t,r){return(t=wn(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wn(e){var t=function(e,t){if("object"!=on(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=on(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==on(t)?t:t+""}var gn=new n.Vector3,kn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hn(e,t)}(r,e);var t=yn(r);function r(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";return ln(this,r),mn(vn(e=t.call(this)),"plantData",{}),mn(vn(e),"harvestBounds",new a.Ae(.5*-r.SIZE.x,.5*-r.SIZE.z,r.SIZE.x,r.SIZE.z)),e.plant=o,e.plant||(e.plant=r.getRandomPlant(i)),e.plants=[],e.plantGeometry=null,e.plantMaterial=null,e.noUpdate=er.c.get("noUpdate"),e.dummy=new n.Object3D,e}return fn(r,[{key:"plant",get:function(){return this.plantData.type},set:function(e){var t=r.getPlantConfig(e)||{};this.plantData=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?un(Object(r),!0).forEach((function(t){mn(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):un(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t)}}]),fn(r,[{key:"init",value:function(){var e=r.getPlantConfig(this.plant),t=s.PD("plants/".concat(e.type)),o=null;if(t.traverse((function(e){e.isMesh&&(o=e)})),!o)throw new Error("Plant model does not contain mesh");var i=o.geometry.clone();i.scale(e.scale,e.scale,e.scale);var a=s.Hp("textures/farm-combine"),u=new n.MeshStandardMaterial({map:a});this.plantGeometry=i,this.plantMaterial=u;var l=e.countX*e.countZ;this.view=new n.InstancedMesh(i,u,l),this.add(this.view);for(var c=0,f=0;f<e.countZ;f++)for(var h=0;h<e.countX;h++){var y=-r.SIZE.x/2+h*r.SIZE.x/e.countX,p=-r.SIZE.z/2+f*r.SIZE.z/e.countZ;y+=Math.random()-.5,p+=Math.random()-.5,this.dummy.position.set(y,0,p),this.dummy.scale.setScalar(.75+.25*Math.random()),this.dummy.rotation.y=Math.random()*Math.PI*2,this.plants.push({x:y,z:p,collected:!1,angle:this.dummy.rotation.y,scale:this.dummy.scale.x,worldPosition:this.localToWorld(new n.Vector3(y,0,p))}),this.dummy.updateMatrix(),this.view.setMatrixAt(c,this.dummy.matrix),c++}}},{key:"_containsShape",value:function(e){switch(e.type){case a.HS.POLY:for(var t=0;t<e.points.length;t+=2){gn.set(e.points[t],0,e.points[t+1]);var r=this.worldToLocal(gn),n=r.x,o=r.z;if(this.harvestBounds.contains(n,o))return!0}return!1;case a.HS.RECT:var i=this.worldToLocal(gn.set(e.width,0,e.height)),s=(i.x,i.z,this.worldToLocal(gn.set(e.x,0,e.y)));s.x,s.z;return!0;case a.HS.CIRC:var u=this.worldToLocal(gn.set(e.x,e.radius,e.y)),l=u.x,c=u.z,f=u.y;return!!this.harvestBounds.contains(l,c)||!!this.harvestBounds.clone().pad(f,f).contains(l,c);default:return!0}}},{key:"harvest",value:function(e){var t,r=!1,n=an(e.harvestShapes.values());try{for(n.s();!(t=n.n()).done;){var o=t.value;if(r=this._containsShape(o))break}}catch(e){n.e(e)}finally{n.f()}if(r){for(var i,a=[],s=0;s<this.plants.length;s++)(i=this.plants[s]).collected||(i.collected=e.isPointInHarvestArea(i.x,i.z,this),i.collected&&a.push(i));for(var u=0,l=a;u<l.length;u++){var c=l[u];this.noUpdate||(this.dummy.scale.setScalar(1e-5),this.dummy.position.set(c.x,0,c.z),this.dummy.updateMatrix(),this.view.setMatrixAt(this.plants.indexOf(c),this.dummy.matrix),this.view.instanceMatrix.needsUpdate=!0)}return a.length&&kr.X.emit("harvest",{field:this,plants:a}),a.length}}},{key:"dispose",value:function(){this.plantGeometry.dispose(),this.view.dispose()}},{key:"totalPlants",get:function(){return this.plants.length}},{key:"collectedPlants",get:function(){return this.plants.filter((function(e){return e.collected})).length}},{key:"plantsLeft",get:function(){return this.plants.filter((function(e){return!e.collected})).length}},{key:"totalCrops",get:function(){return this.totalPlants*this.plantData.plantCost}},{key:"collectedCrops",get:function(){return this.collectedPlants*this.plantData.plantCost}},{key:"cropsLeft",get:function(){return this.totalCrops-this.collectedCrops}}],[{key:"getRandomPlant",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",r=[],n=an(nn);try{for(n.s();!(e=n.n()).done;){var o=e.value;o.theme===t&&r.push(o)}}catch(e){n.e(e)}finally{n.f()}return r[Math.floor(Math.random()*r.length)].type}},{key:"getPlantConfig",value:function(e){return nn.find((function(t){return t.type===e}))}}]),r}(n.Group);mn(kn,"PLANTS",nn),mn(kn,"SIZE",{x:56,z:28});const Pn=kn;function Sn(e){return Sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sn(e)}function On(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function jn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dn(n.key),n)}}function xn(e,t){return xn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xn(e,t)}function _n(e){var t=Cn();return function(){var r,n=An(e);if(t){var o=An(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Tn(this,r)}}function Tn(e,t){if(t&&("object"==Sn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Bn(e)}function Bn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Cn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Cn=function(){return!!e})()}function An(e){return An=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},An(e)}function Mn(e,t,r){return(t=Dn(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dn(e){var t=function(e,t){if("object"!=Sn(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Sn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Sn(t)?t:t+""}var Rn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xn(e,t)}(l,e);var t,r,o,i,a,u=_n(l);function l(e,t,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),Mn(Bn(n=u.call(this)),"view",null),Mn(Bn(n),"body",null),Mn(Bn(n),"isSheaf",!0),Mn(Bn(n),"cropType",""),Mn(Bn(n),"dropValue",_.gL.HJ),n.renderOrder=1e3,n.level=e,n.cropType=t,n.dropValue=Math.max(0,~~r),n.createView(),n}return t=l,r=[{key:"createView",value:(i=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.view=s.PD("sheafs/"+this.cropType),this.view.scale.setScalar(.009),this.add(this.view),t=new n.MeshStandardMaterial({map:s.Hp("textures/farm-combine")}),this.view.traverse((function(e){e.isMesh&&(e.material=t)}));case 5:case"end":return e.stop()}}),e,this)})),a=function(){var e=this,t=arguments;return new Promise((function(r,n){var o=i.apply(e,t);function a(e){On(o,r,n,a,s,"next",e)}function s(e){On(o,r,n,a,s,"throw",e)}a(void 0)}))},function(){return a.apply(this,arguments)})},{key:"updateTransformFromObject",value:function(e){var t=e.position,r=e.quaternion;t&&(this.position.copy(t),this.setPosition()),r&&(this.quaternion.copy(r),this.setQuaternion())}},{key:"setPosition",value:function(){arguments.length>0&&void 0!==arguments[0]||this.position}},{key:"setQuaternion",value:function(){arguments.length>0&&void 0!==arguments[0]||this.quaternion}},{key:"handleDestroy",value:function(){}}],r&&jn(t.prototype,r),o&&jn(t,o),Object.defineProperty(t,"prototype",{writable:!1}),l}(n.Group);const En=Rn;function In(e){return In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},In(e)}function Ln(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zn(n.key),n)}}function Fn(e,t,r){return(t=zn(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zn(e){var t=function(e,t){if("object"!=In(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=In(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==In(t)?t:t+""}var Gn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Fn(this,"harvestedPlants",new Map),Fn(this,"leaderboard",[]),Fn(this,"harvestProgress",0),Fn(this,"isDead",!1),Fn(this,"wasRevived",!1)}var t,r,n;return t=e,n=[{key:"create",value:function(e){var t,r,n=new this;return e.player&&(n.isDead=e.player.isDead,n.wasRevived=e.player.wasRevived,n.harvestProgress=Math.max(0,Math.min(1,(null===(t=e.player.harvester)||void 0===t?void 0:t.harvestProgress)||0)),n.leaderboard=e.leaderboard,n.harvestedPlants=(null===(r=e.player.harvester)||void 0===r?void 0:r.calculateHarvestedResult())||new Map),n}},{key:"createDeathResult",value:function(e){var t=this.create(e);return t.isDead=!0,t}},{key:"createEndResult",value:function(e){var t=this.create(e);return t.isDead=!1,t}}],(r=[{key:"percent",get:function(){return this.harvestProgress}}])&&Ln(t.prototype,r),n&&Ln(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();const Vn=JSON.parse('["Bullet","Biggie","Hawk","Dizzy","Magica","Chip","Grace","Cheery","Miracle","Mitzi","Vulture","Skin","Ziggy","Major","Pugs","Duke","Stone","Spuds","Horse","Devil","Undertaker","Sandy","Cloud","Jelly","Honesty","Sizzle","Prince","Dodo","Dawg","Smitty","Stone","Ice","Smiley","Kazantip","Kolbasa","Kirk","Turbo","JoJo","Jericho","Knight","C0mB0","Bob","RedAlert","Gnom","Ukraine","USA","Moon","Albert","Nomad","Princess","Boiiiii","Sans","Rex","Drezden","Bazooka","Creep","Australia","China","Racoon","Apache","Krenko","Garrook","Cobra","Cryo","Speedy","Flash","Smol","Ice","Smite","Ace","Danger","Fireball","Kolya","Vernon","Geralt","Owl","Cook","UwU","OwO","Quin","Radio","Max","Pivot","Spike","Vergil","METAL","Corriban","qwerty","Torbran","DiscoParty","Qwazar","io","Mask","Ziz","MaryJ","Nasty","Nancy","Holy","Moly","oO","Oo","OoO","Japan","Africa","France","Moon","Italy","Spain","Brazil","Strawb3rry","1o1","Vertex","Vortex","Quick","WoW","Ergo","Raster","YoYo","OneUp","Pop","Akira","Smack","Drop","Flop","Grape","Hop","John","Karmack","LaLaLaLa","XOR","Crisp","Bulk","NaN","Mosquito","Dodo","Captain","Andrew","Gregor","Zamza","Ajani","Strike","GoGoGo","SWAT","Raiz","Pox","Rock","Pumba","Nike","Grom","Fargo","Zmiy","Western","Koshka","Bambi","Friendly","Cat","Mau5","Trouffel","Derick","TuTuRu","EMOJI","QwQ","Quirk","Roomba","Artemida","Artos","Portos","Aramis","Brat","Jack","John","Sm1th","Lelo","Pepo","Vector","Cap","Eric","Agent007","Dervish","Corporal","Snek","Jet","Servo","Pumpkin","Mellon","Asgard","Doctor","Strange","Thor","Batman","Maverick","Wolverine","Magnetto","Phoenix","Drew","Hulk","Comet","Raider","Berserk","Magus","D33R","C3P0","BOT","Doedre","Cowboy","Mask","Cyborg","XoX","Amonket","Konan","Runner","Mexico","Qween","King","Graf","Havoc","Pepega","Astro","YEE","Luma","Luna","Keepo","Meepo","Joy","Jonathan","Yorlung","Hjalmor","France","Overmind","Carrier","Ion","Moon","Sun","Jelly","Blob","Heart","Rumble","Western","Ginger","Jace","Chandra","Liliana","Xuan","YoLo","KoRn","Nirvana","Bass","UAZ","Opal","Uno","Delta","Foxtrot","Capri","James","DJ","Calipso","Mix","Zimbra","Pandora","Curtis","Vendo","Panda","Snek","Turtle","Felix","Phoenix","Ashen","Shock","Florida","Shazam","Goobert","Rob","Zombie","Steel","Silver","Horizon","Millennium","Rent","Brienna","Zion","Kontra","Wednesday","Esper","Grixis","Lemon","Covfee","Monkey","Styler","Nexus","Prey","RDR","Icon","DRY","Quirky","DrDre","Holmes","GG","Swipe","Smack","Storm","Vesemir","Ciri","Yennifer","Triss","Energy","Firestorm","Asphalt","DOS","Windows","Unix","MacOS","Android","Cyborg","IOS","Jona","CoVid","SMS","DialUP","Cpt","Pts","Jerry","Meme","Zorro","Kirac","Flax","MP3","XoX","Maple","Bronx","Jamal","Curry","CDRom","Drop","Asus","Dell","Nvidia","AMD","Blob","RP","XC","Noric","Spartan","Rumbazaur","Pepega","Ra","Ozzie","Jackiro","Chan","Panzer","Harvester","OxO","qOxOp","qIOxOIp","Magenta","Sam","Copper","Uga","Buga","Lemon","Kepler","Mark","Travolta","Trev","Hulk","Bruno","Brick","ZiZ","PoP","Kunai","Rick","Norm","Mortie","50Cents","Fork","Lana","Uni","Greek","Catty","Poggy","Kitty","KPoP","Frag","Rox","Yee","Duran","Kerrigan","Roro","Lokki","Turbo","Boop","monkaS","James","Vivien","Verdan","Kat","Katherine","Jane","Alice","Kate","Olga","Erica","Yana","Ukko","Stef","Cute","Veil","Berry","Nate","Mike","DARE","Gorillaz","Daril","Aron","Baby","Jump","Loop","Jessie","Dilan","Colin","Paup","Lopez","Jeff","Bin","Sally","Nate","Sam","Trev","kZ","Mask","Siren","Pow","Lamb","gg","qwerty","Trove","Boss","ZAWARUDO","Ikoria","Gnome","Anx","Pony","Pete","Python","Monty","Astronomia","QuacQ","Mendy","XaX","Patriot","Pepe","Daril","Noris","Sofia","OP","zxAsKxz","Truman","Bruh","Gwin","Dru","Andy","Ace","WM","Murphy","Al","Freddy","Kimball","ayyyLmao","Dank","Dery","Dero","Ramo","EL","Jaimie","Lewa","Lewie","Jay","PG","Robo","Kay","BigChip","Blacko","SymphonyX","LL","Jim","Jackie","Jacky","Sea","Charly","Cartella","Brenna","Brennie","Chick","Paula","Charlie","Collie","Dowel","Greg","Joker","GrandMan","GamerFox","FoxGirl","Tony","DrBrave","H3nry","M3l1ss4","Elephant","Rex","Ch4rl13","St3v3","Solid","Taurusrex","S4nDr4","Ad1b","J03","Steff","St3ph4n13","Hennie","M3lv1n","Giulia","Wobbly","MrChubby","Janey","Kitsune","KittenGirl","Koala","AngryOwl","Snek","V","Lady","Luck","PureSkillz","V4s1l1s4","Guppy","Don4ld","Trump3t","Angrie","Emma","Emmanuel","Ostrich","St1cky","Hampsta","Rob3rto","Carleone","N1c0l3","F4rz4n","Forsen","Keepo","Alfreda","S0phi3","Garyn","Giraffe","Anuja","BearGrillz","Badger","Slim3r","Toad","Cosmo","Petra","Christo","ElfEars","Marcello","DAWAE","Martin","SinisterDD","Williamz","Lizard","Khalila","MichaelLer","CorterHauz","VictorZ","Bunny","TokyoFox","MissV","Canonic","Ponie","Sharkie","Fam","PamPam","Admin","Ekko","Laura","Fedor","Masquitto","Elk33","Mario","Komba","Euro","DollaGang","Slam","Paradox","MaxStrife","Peggy","Klib","Ok","Goomba","PeepoRage","PopStar","Viktor","Maxim","Pete","Peter","Markov","Praga","Komic","Zaur","Taras","NoBrakes","Eron","Yorik","Hax","Slidan","Omen","Birmah","UwU","Goblin","Xardas","NotEvenLUL","TopKEK","TheOne","Zub","Mahmud","Axe","Trazm","Goto","Basilisk","G0mB4","Crash","Frank","Beast","Ugo","Robin","BackMan","Erg0","Santa","Squid","Param","Opiq","DoctorQQ","PacMan","Gj","XD","ImFirst","L4W","GF","Baris","Joanna","Helen","Waifu","Maiden","Victoria","Daria","Tatoo","Olivia","Ava","Isabella","Sophia","Charlotte","Mia","Amelia","Meg","Dior","Adalee","Palmer","Oaklynn","Haisley","Keily","Novah","Yara","Ensley","Reese","Mika","Amina","Aura","Billie","Stevie","Drew","Tyler","Ryan","Ari","River","Cameron","Sam","Tatum","Corey","Frankie","Evelyn","Emily","Elizabeth","Mila","Ella","Ella","Camila","Aria","Grace","Lily","Hannah","Aurora","Claire","Lucy","Maya","Naomi","Cora","Isla","Ivy","Alexa","Damon","Sasha","Axel","Layla","Gem","Nadia","Aidan","Miah","Emmalyn","Owen","Ellis","Russell","Piper","Valory","Acira","Tracy","Nivek","Sandra","Irret","Nate","Etan","Paul","4l1sh4","Aon","Ilana","Joanne","Otis","STONK","ArchEnemy","AIC","Showdown","Broom","Bamboo","Aizul","Ban6","GG6","Vass","Nori","Mexo","Mix4","Elija","Pepper","QUICK","BEST","Gerbert","ZOOM","exDee","10Years","YoYo","Drax","Bilbo","Fr0d0","Ajax","Ew","SSS","B00M","Goal","Clash","Nibiru","Legit","XAE12","SaturnX","Exp","Magnet","Ph03n1x","1M1C","Jeka","DrPepper","MtD3w","D0R1t03s","T0T3M","M3eRrY","f4ll","jim","farrie","Dirby","xaM","Bulldos3r","Jk","N0M3R","oxO","B1b0","Bilbo","Doggo","Frodo","Peter","Pete","M8","Mass","Gas","Trump","KimJ","Amass","Juice","Law","Mack","Aphone","xp","MeanDude","Poli","Kappa","Dota2","Meta","Jaba","Yaric","Yamaha","Berezka","JN","Kopilka","Normer","Falmer","Beluga","Bear","Hollie","Benjamin","BigB","Grinner","J0k3r","LastOfUs","Utopia","U2","Gaga","Merci","Toyota","BMW","Romero","Carmack","Jeans","2007","1337","Never","Give","you","up","Jax","Fatale","Derail","EA","Sponsor","Cop","Sorry","FastnFury","BOI","Best","TheBest","B3tt3r","M0B1L3","Bloom","D3Str0y3r","Slayer","Alpaca","Neut","B0X","Apox","Med1at0r","Br0","PamPamPam","Dude","StopEat","GoVegan","DontEatMe","BlackHole","Armin","ClapClap","EZ","Speedster","Z00M3R","Boomer","Millenial","Disturbed","Pogg","ZxZ","Mekka","Pogo","Maric","Elf","Dwarf","SoS","SendHelp","Resistance","DeusEx","Marko","G1rl","B0y","Pal","Kattie","Josh","Joseph","KGB","Popov","Leamur","L0v3","Amanda","Qt","Ernando","Dolce","Vita","Victoria","Tan","Maks","Amigo","Google","Bingo","Joric","Lapiz","Mynicrift","JVO","PSILIPH","SINEMS","KOBAK","Teenhies","Panoconis","Masiontoch","SYNO","PIENOCR","TAFEL","Riko","Dazy","Karron","Domingo","Barbossa","Ron","Collar","Pro","Donator","io","Abba","Sabbath","Dorito","Taco","Slowdown","Police","Angela","Queen","Zik","Ulana","Iren","Jay","Daneka","Rika","Honey","Roberto","Drill","Jaw","Mouth","Pope","Era","Virus","Terminus","Hallow","Liqid99","Yeah","Op","First","Goomba","Wario","Clive","Steve","Nata","Trevis","Diana","Dyne","Cassie","Cass","Kas","KY","Q","QQ","Kin","Etsilop","ElonMask","Bolgario","Tsak","Joy","Monk","Minycraft","BML","Frag","Zenith","M21","Bimba","Belf","Smaq","Uru","OiOiOi","Farzan","Ramirez","Celina","Chewy","Kenn","Dave","Dai","Benita","Eugene","Jamia","Kristina","Warren","Emelie","Allen","Victorine","Fifi","Fisher","Etta","Brenna","Cosma","Jerica","Gibson","Reed","Bryan","Faustina","Freda","Reyes","Sam","Joseph","Tony","Chapman","Roberta","James","Edwards","Louis","Christina","Thompson","Keitha","Hassan","Freeman","Laurie","Jude","Olson","King","Dean","Farzaneh","Farzaneh","Kevin","Marshall","l","Mathilde","Nikolia","Nikki","Vedi","Vidi","Vici","Tille","Massive","Maxine","Oliver","Romero","Ollie","Fetid","Dank","Daft","Clever","Marvie","Vasbob","Charles","Marc","Mason","Mary","Mario","Russell","Paula","Walker","Zlatan","Anila","Powel","Gary","Moore","Leon","Wallace","Christian","Ryu","Benita","Lane","Alana","Gibson","Nicolas","Cole","Stina","Teresa","Juana","Lopez","Phillippa","Chrissy","Karen","Christi","Tiphanie","Aeon","Saki","Hero","Yukiko","Amane","Yosuke","Flux","Riu","Aiya","Jill","Veronika","Tart","Daft","Tangy","Dim","Dimov","Chewy","Charriot","Tower","Fool","Enrika","Hattie","Enrika","Kevia","Marie","Sweet","Kitty","Miry","Marty","Derek","Kanji","Trevor","Goodchild","Frederika","Judith","Freaky","Jimbo","Jolt","Abyss","Gram","Desert","Frieda","Frikka","Frederica","Cake","Donna","Brendan","Pegasus","Unicorn","Juicy","Sandra","Louella","Klaudie","Mate","Matthew","Miska","Janey","Justin","Ann","Groovy","Nova","Foxxie","Lime","Utopia","Moralist","Jeronimo","Bazalt","Bishkek","Baiden","Trump","Vissus","Xoxoxox","Audio","Bentli","Merz","Cyberdrunk","Jess","Magica","Disspls","DontEatMe","Nopls","EatMeNot","First","Best","MMMM","GoGoGo","FirstOne","Cucumber","Weeeeeeee","BOBISHERE","Kek","Dejavu","RunRunRun","Aaaaaaaaa","123","qwerty","Haru","Futaba","Yu","Prodigy","Ramm","Janes","Mona","Skull","Oracle","Akechi","Sae","Vasya1313","Guf","Makoto","Spielberg","Wacom","PS5","RTX3090","Pog","Bibble","Azz","Nokia3310","DoorStuck","AFK","Turo","Sojiro","Kuma","Director","AlanWake","Bisquit","Jojojojo","Aaaaaaaaaa","Donoteat","Yokko","Quoooo","Lizzy","Meh","Astronomia","Alien","Gas","Hop","Slon","Bakka","GoddToward","Velnyas","Hero","Mihx","Cloc","Errrrrr","Unnamed","Jinn","Shido","Kekechi","BlockBlast","Bae","MyDude","Wot","Gibbs","PS4","Sony","Brink","Child","QoP","Jokie","Yeezie","RTX3080","RTX3080","Drum","Badumtss","Jaguar","Messi","Peepo","Rage","Trickster","Igor","Automaton","Bublik","Vera","Katty333","8576","911","Adam","Jensen","Gr0t","Mist","Cell","Akko","Biba","MoJIoKo","Yam","GitGood","YuhanBat","WRYYYY","WinningSon","Nope","Horizon","Lightning","Magg","Norie","Trump","Wakeup","Summer","Fedor","Ren","Akki","Peoo","Slap","Norman","KoJIeCo","Huawei","Xiaomi","Jimbo","HUHUHU","Move","Phoenix","Fex","Faz","KKKKKKKK","DontEatMe","IDDQD","PeepoRage","Kappa","RossBob","Amanda","Som","Sydak","Tydak","Minx","Asdfghj","GoldenBiba","Vanger","qweeqweq","Joker","Stryke","QQQQQQQQ","Whatever","HOOBOY","Kzkzkzkzkz","Kameha","Carpet","Smeargool","Snek","Boris","Gruz64","1233456789","1337","IOS","LisaSu","Amd","Intel","Nvidia","Wiv","Bomber","Zazik","Pog","PogU","Brenda","Ruiz","Ann","CSofia","Sandy","City","Coca Cola","Sofinator","redrat","chordstyx","antmir","hamfox","cakebee","Sun","Datsune","Lisa","Jean","Amber","Barbara","Klee","Noele","Fischl","Sucrose","Mona","Beidou","Qiqi","Keqing","Snowflake","Pepop","BopBip","Stahp","Rosemarie","exoxtic","kenyon","necla","nesrin","Metin","Baker","Tania","Dark_Angel","Andres","Emily","Mozz","Folk Rock","Huzzzzzz","GrizzWoltz","Pilz Here","Eric Danq","Crop Prop","JoJo","Mister D","Sister Z","Striker","Bambino","X Ray","Le Name","Le Toucan","Press F","Me me me","Naftalin","420","He he Boi","Vendigo","Boriska","Ak 47","Bifshtecks","Zer Man","QwQ QwQ","Giff Likes","Robo Drop","Nikes G","JIoM","2 Fast 4 U","Rare","\'H O O BOI \'","JK JK","STAHP","T J","Mishka","HoneyP","Fat Joe","Jack Frost","Black Jack","CutieAYAYA","MonkaS","WTFF","DrWeb","Krispersky","Wisdows","Huba Beyb","Sikorsky","Misha Vse","AAAAA KEY","kokokokoko","Ls Go Brrr","Number 9","Zero Wolf","Ser Maxim","Frederick","Poncho San","DrMountain","Milk Shake","SD   DS","Cataclysm","DDDA","PotapKa","Mithryl","Madel","Zina","Kekos","Dirka","Wob Wob","L oo per","Kinemantle","1337 Ziz","\'Herbert \'","YEE","Top 1","We R Lego","Rodrigez","8Bit Peepo","Magus 7777","Clark Pent","Soap","\'1 1 1 1 1 \'","GO YA SOZD","SOI BOI","Jelly Flop","Frigor","Ingle","6 Fold","9 Gag","Pikabu","Steal Y","Y THO","Miceraft","Jo Jo","Zarab","Bobik","Wuts this","Maradonna","Keoo","King Xong","Rap Dog","Eminem","Friska","Borsch","Mick Gram","Lil Big","Holup","Dont Eat","Pls no eat","Kapucino","Mikky","Grigor","Jojak","Jen","Yun","Vivien","Yuv","Kent","Beckie","Masha","Indigo","Norka","Verdana","MonsterT","Colliseum","Ayayaya","PeepoKnife","Troll","Speedster","Celebrity","Huba Buba","Trump Won","Smack Dem","Bnbnbnbnbn","aaaaaaaaaa","qqq","Bruh","Bold Dude","Jen","Jessica","Keily","Keily","Cat Vibin","ooomoya","oborona","Gif","Catdog","Madeleine","Selene","Aelinore","Mercedes","Quina","Reynard","Anri","Cale","Camellia","Caren","Emme","Milly","Mirabelle","Morys","Meredith","Mayra","Maurin","Ewald","Otzi","Ferris","Feste","Flavin","Pablos","Quince","Ramon","Ramen","Ranseur","Rojay","Rook","Rorric","Rowland","Orlando","Russet","Rychard","Salomet","Salde","Savan","Sens","Francis","Valmiro","Tagert","Vanna","Wilhem","Wenda","Walker","Miss","Guggu","Nothx","Malice","Freya","Xiao","AquaDisco","Snow","Frost","Brink","Mekeke","Garum","Br0leg","Visssss","Hohoho","Captcha","qyqyqy","Siren","Mix","Anty","Katie","Jean","Lissa","Rob","Bob","QwQ","Yeeehaw","HolyCat","OOOOOOO","Sweetie","Ruru","QQ","Rica","Rita","Rima","Tamara","Twinkle","Tim","Yin","Iona","Opie","Perry","Paimon","Astra","Amelia","Am","Amy","Ann","Sara","Ser Gut","Sim","Dillan","Derby","Fishcl","Fish3","Geerl","GiiiiiiG","Harry","Help","Chloe","James","Jin","Jessica","Jerry","Jk","Lola","Lem","Leonardo","Lel","LUL","KEK","asdasdasd","qweqw","Zarrie","Zajum","Zic","Xexryx","Xsar","Claudie","Clodd","CK","CsSS","Vibe","VibinCat","Block","Misssie","Marty","Mitch","Merrie","Moxie","Meredith","Lois","Lous","Kerbal","KSP","Impostor","Shevy","Dillan","Vendy","Bloss","Grey","Mariya","Kamilla","Dorry","Bless","Frame","N@S@","P1Pn@","$$$$$$","B01nk@","\'@3@3@3@3\'","Jjjssa","\'@##@##@##@\'","KOKOKOKO","\'&^$%\'","^_^","^_^ oWo","Milka","\'{}{}{}{}{}\'","\'@@@@@@@\'","$$$$$","\'!*@#&\'","123124123","Jiasd","\'&&&&\'","??????","Ukrainochka)","dex","HactugHet","\'#RZRTOP\'","Vechnost\'","Tvou Ocean.","Tyanoshka","ExC!uT","Miami.","UPS.","CHerubi.","Soulless.",".BlackBullet.","Donyshko","Claudinus","Myshka","NE VETER","Super Cat","Leon.","XiPsTeR","Radiculitics","BB Teegrew","Tizh\'","\'#Karamel\'\'\'","attached","SuicideSilence","Nixel","_Hentai_","Moon.","Kapriz","Derzkaya..","NuboLom","MESSI","Samurai.","Kes.","\'- bb -\'","\'#Supreme.\'","bomzh","A-One","R I D D D L E","Sushka","Sparkle.","MRAZYUL\'KA","gygygy","Zvereva69","Dr@gon Sl@yer.","-Ps-","Alice","TochkaMay","Dreikes","Amplus","322","Jassko","ScreaM","MAx","IraTashchor","Best.","\'*Ilita*\'","SD","CHili.","AttackonTitan","Kumys","Exper5","\'#Animeshnitsa\'","MmrRrofff","\'#F5\'","Cpasya","Akio","Ananas.","\'*Changeling*\'","\'#ZefTheBest\'","ZUB-NOJ","Sanik.","MrKosjaK","Rooster.","Sawer.","UPS!","\'#MrHananFans\'","PSIH","Rusalka","Magikal","Not Sleep","Listik","Dimak","Shiina Mashiro","MmYAyaUu","Holopopiness","DIGI","Igroman","goner.","Nui","Chemp","KOT 3006","Dipsize.","LoMaster","Rubilaks","Ridddle","Margaux","Transformers","\'CHINESE\'","bomzh","SsreaM","kraz0r","A R E S","NOTOR1OU5+","\'#ChilieTheBest\'","Toriloki","Ragnaryok","Kojojo","kot","Ruli","Cobalt.","ZVEZDOCHKA","-Rs-","korbendallas","PUMBA 2","DARZ","z0nG","Pustye","Tishe....","GG","Kvitka dusha )","Infinitum","\'#Odinokij\'","CHiker^^","Slime","UsTriCa","Esperanza.","Lerusya","jozh","Ali.","Il\'ya pro","Bloodthirsty","Carbon","Pika","Style","MotoBRO","Exstaz.","AA","kAi","Dawn","iceblinke","Xs","A-K","U_e","Snow.Snow","Royal","nohappy","AF","QWERTY","Insane","Benio","Remember me","jennyhong","omegay ray","Villain","X.","Destiny.","M.A.X","Ukraine","Mykyta Blizko","Gudvin","Harvey","UKRAINE","Vebster2.0","CHERNIHIV","AlexCoachman","CHERNIHIV","Diogen","Unknown Unknown","CHERNIHIV","Deny","Aniloks","yh","Agent ZOG","Yule Cat","Nedochelowek","Marshal_New_Arleana","Emil Imrani","Avatar Of LoKI","Piligrim380","\'Onedayman \'","\'lergvot \'","sir-coffee","Riverander Aniki","Anonecky","Andrey SkyZerx","123 321","Lonely Vasyan","Yule Cat","NightSoul Reaver","Javellinh Outdesc","Simon","Ilia Orlenok","Le Roi de ta mre","USERNAME","D mitry","Lomo Voy","Pavel Ruban","CHERNIHIV","dfkkg","Gija -","Barracuda","Nek Fury","Atheris","Aki Ross","DanilaDanilkin","realavt","CHERNIHIV","\'Sergey \'","\'Goodmanchik \'","\'leo b \'","\'Granger \'","Ursus Mursus","CHERNIHIV","Piligrim380","\'Sangeims \'","\'Max \'","\'newoldmax \'","\'Image \'","\'Lombax \'","\'bewareofgod \'","\'36saphirus \'","\'Sam Tokov \'","\'Mankustrap \'","Humsterr","Ray Madhope","\'Mankustrap \'","\'Andrusqaaa \'","\'Help me \'","\'Jonny Kawer \'","Yana","$weet1e","Tweeter","Black Wood","Dozaemon","VS","AnDyLawless","arghan3","John Doe","CHERNIHIV","Ascron","Ut ui","Totorimoto","Kan Sh","Charlotte152630","jimm-xattab","Kyiv","Dobryak Dobreyshiy","The Lol96","Maxym Wasin","Judge Jameson","Ram Ka","Gonzo","Kysh","Ayanokoji","ED lightbringer","Fin4 ***","Atheris","legion2709","xikku","YaSyelTebya","Uncle Xbox","aviss kan","Renniw","Jorj Jorj","\'CFW Fate \'","Lemon5ky","Tvorog","El Yar","red pill","Ilia Ronyo","KonstPlay","speedy tm","Deckven","J Paganel69","\'Tentacle  \'","\'JDS  \'","\'One One  \'","FlyTroll","\'JohnKey  \'","Ggleplus Suxx","feuerrader","Grub4dos","TVEYE","Milleroff","JohnKey","\'Cornelius  \'","\'Sturbridge  \'","\'REM1X  \'","Cormade Suhov","Shikari","Ursus Mursus","\'lotan\'","Shadowlordm","Drunken Furby","Korm","duel song","Forza Azzurri","Bigtiger","aiKEK","kekWat","pepeHands","J4BA","wolma4k","KAILER","SlavPotato","Veles","Hop","Gr3yt1d3","SaveUkraine","StopPutin","StopTheWar"]');var Zn=r(2115);function Nn(e){return Nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nn(e)}function Hn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yn(n.key),n)}}function Xn(e,t){return Xn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Xn(e,t)}function Kn(e){var t=Jn();return function(){var r,n=qn(e);if(t){var o=qn(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Wn(this,r)}}function Wn(e,t){if(t&&("object"==Nn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Un(e)}function Un(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Jn=function(){return!!e})()}function qn(e){return qn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},qn(e)}function Qn(e,t,r){return(t=Yn(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yn(e){var t=function(e,t){if("object"!=Nn(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Nn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Nn(t)?t:t+""}var $n=new n.Vector3,eo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xn(e,t)}(a,e);var t,r,o,i=Kn(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),Qn(Un(t=i.call(this)),"center",new n.Vector3),Qn(Un(t),"extents",new n.Vector3),t.center.set(-e.center.x,0,e.center.y),t.extents.set(e.extents.x,.1,e.extents.y),t}return t=a,r=[{key:"getPointAt",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new n.Vector3;return r.copy(this.center),$n.copy(this.extents),$n.x*=e-.5,$n.z*=t-.5,r.add($n)}},{key:"getRandomPoint",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new n.Vector3;return this.getPointAt(Math.random(),Math.random(),e)}}],r&&Hn(t.prototype,r),o&&Hn(t,o),Object.defineProperty(t,"prototype",{writable:!1}),a}(n.Box2);function to(e){return to="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},to(e)}function ro(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=io(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function no(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||io(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oo(e){return function(e){if(Array.isArray(e))return ao(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||io(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function io(e,t){if(e){if("string"==typeof e)return ao(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ao(e,t):void 0}}function ao(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function so(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lo(n.key),n)}}function uo(e,t,r){return(t=lo(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lo(e){var t=function(e,t){if("object"!=to(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=to(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==to(t)?t:t+""}var co=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),uo(this,"_lookup",new Map),uo(this,"_table",[]),uo(this,"_sumWeight",0)}var t,r,n;return t=e,(r=[{key:"_calculate",value:function(){var e;this._table.splice(0),this._sumWeight=0;var t=oo(this._lookup.entries());t.sort((function(e,t){return t[1]-e[1]}));for(var r=0;r<t.length;r++){var n=no(t[r],2),o=(n[0],n[1]);t[r][1]+=this._sumWeight,this._sumWeight+=o}(e=this._table).push.apply(e,oo(t))}},{key:"rollRandom",value:function(){if(this._table.length){var e,t=Math.random()*this._sumWeight,r=ro(this._table);try{for(r.s();!(e=r.n()).done;){var n=no(e.value,2),o=n[0];if(t<=n[1])return o}}catch(e){r.e(e)}finally{r.f()}return this._table[0][0]}}},{key:"add",value:function(e,t){var r=(this._lookup.get(t)||0)+e;this._lookup.set(t,r),this._calculate()}},{key:"clear",value:function(){this._table.splice(0),this._lookup.clear(),this._sumWeight=0}},{key:"copyTo",value:function(e){e.clear();var t,r=ro(this._table);try{for(r.s();!(t=r.n()).done;){var n=no(t.value,2),o=n[0],i=n[1];e.add(i,o)}}catch(e){r.e(e)}finally{r.f()}return e}},{key:"removeElement",value:function(e){this._lookup.has(e)&&(this._lookup.delete(e),this._calculate())}}])&&so(t.prototype,r),n&&so(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function fo(e){return fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fo(e)}function ho(e){return function(e){if(Array.isArray(e))return yo(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return yo(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?yo(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function po(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bo(n.key),n)}}function vo(e,t,r){return(t=bo(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bo(e){var t=function(e,t){if("object"!=fo(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=fo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==fo(t)?t:t+""}var mo=new Map,wo=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),vo(this,"id",""),vo(this,"iconId",0),vo(this,"disabled",!1),vo(this,"boosterNameKey",""),vo(this,"adsBonusTextKey",""),vo(this,"hasAdsBonus",!0),vo(this,"pickupRadius",2),vo(this,"duration",-1),vo(this,"adsBonusDuration",0),vo(this,"aiUsageChance",.5),vo(this,"aiUsageDelayMin",10),vo(this,"aiUsageDelayMax",20),vo(this,"cannotBeUsedWhenActive",[]),vo(this,"adsBased",!1)}var t,r,n;return t=e,r=[{key:"getDuration",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e?this.duration+this.adsBonusDuration:this.duration}},{key:"_applyData",value:function(e){e&&(this.disabled=!!e.disabled,this.boosterNameKey=e.boosterNameKey,this.adsBonusTextKey=e.adsBonusTextKey,this.hasAdsBonus=e.hasAdsBonus,this.pickupRadius=e.pickupRadius,this.duration=e.duration,this.adsBonusDuration=e.adsBonusDuration,this.aiUsageChance=e.aiUsageChance,this.aiUsageDelayMin=e.aiUsageDelayMin,this.aiUsageDelayMax=e.aiUsageDelayMax,this.cannotBeUsedWhenActive=ho(e.cannotBeUsedWhenActive),this.equivalentInResult=e.equivalentInResult,this.adsBonusEquivalent=e.adsBonusEquivalent,this.vfxPositionOffset=e.vfxPositionOffset,this.duration<=0&&(this.duration=1/0))}},{key:"activateBoosterFor",value:function(e){ll(this)}},{key:"spawnConditionsMet",value:function(){return!0}},{key:"isPermanent",get:function(){return this.duration<=0}},{key:"incompatibleWith",get:function(){return this.cannotBeUsedWhenActive}},{key:"sprite",get:function(){return"textures/boosters/booster".concat(this.iconId,"InGame")}}],n=[{key:"registerClass",value:function(e){mo.set(e.ID,e)}},{key:"create",value:function(e){var t=new(mo.get(e)||this);return t._applyData(Zn.Z.boosters.boosters[e]),t}},{key:"TYPES",get:function(){return ho(Object.keys(Zn.Z.boosters.boosters))}}],r&&po(t.prototype,r),n&&po(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function go(e){return go="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},go(e)}function ko(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Po(e,t){return Po=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Po(e,t)}function So(e){var t=xo();return function(){var r,n=_o(e);if(t){var o=_o(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Oo(this,r)}}function Oo(e,t){if(t&&("object"==go(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return jo(e)}function jo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xo(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(xo=function(){return!!e})()}function _o(e){return _o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_o(e)}function To(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=go(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=go(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==go(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Bo="booster_megaReel_default",Co=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Po(e,t)}(r,e);var t=So(r);function r(){var e;ko(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return To(jo(e=t.call.apply(t,[this].concat(o))),"id",Bo),To(jo(e),"iconId",1),To(jo(e),"reelLevel",5),e}return r}(wo);function Ao(e){return Ao="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ao(e)}function Mo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Do(e,t){return Do=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Do(e,t)}function Ro(e){var t=Lo();return function(){var r,n=Fo(e);if(t){var o=Fo(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Eo(this,r)}}function Eo(e,t){if(t&&("object"==Ao(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Io(e)}function Io(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lo(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Lo=function(){return!!e})()}function Fo(e){return Fo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Fo(e)}function zo(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=Ao(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Ao(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ao(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}To(Co,"ID",Bo);var Go="booster_speed_default",Vo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Do(e,t)}(r,e);var t=Ro(r);function r(){var e;Mo(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return zo(Io(e=t.call.apply(t,[this].concat(o))),"id",Go),zo(Io(e),"iconId",2),zo(Io(e),"multiplierValue",1.25),e}return r}(wo);function Zo(e){return Zo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zo(e)}function No(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ho(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Yo(n.key),n)}}function Xo(e,t){return Xo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Xo(e,t)}function Ko(e){var t=Jo();return function(){var r,n=qo(e);if(t){var o=qo(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Wo(this,r)}}function Wo(e,t){if(t&&("object"==Zo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Uo(e)}function Uo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jo(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Jo=function(){return!!e})()}function qo(e){return qo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},qo(e)}function Qo(e,t,r){return(t=Yo(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yo(e){var t=function(e,t){if("object"!=Zo(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Zo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Zo(t)?t:t+""}zo(Vo,"ID",Go);var $o="booster_truckMul_default",ei=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xo(e,t)}(i,e);var t,r,n,o=Ko(i);function i(){var e;No(this,i);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Qo(Uo(e=o.call.apply(o,[this].concat(r))),"id",$o),Qo(Uo(e),"iconId",3),Qo(Uo(e),"multiplier",2),e}return t=i,(r=[{key:"spawnConditionsMet",value:function(e){var t;return!(null===(t=e.player)||void 0===t?void 0:t.hasBooster(this.id))}}])&&Ho(t.prototype,r),n&&Ho(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(wo);function ti(e){return ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ti(e)}function ri(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ni(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fi(n.key),n)}}function oi(e,t){return oi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},oi(e,t)}function ii(e){var t=ui();return function(){var r,n=li(e);if(t){var o=li(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ai(this,r)}}function ai(e,t){if(t&&("object"==ti(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return si(e)}function si(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ui(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ui=function(){return!!e})()}function li(e){return li=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},li(e)}function ci(e,t,r){return(t=fi(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fi(e){var t=function(e,t){if("object"!=ti(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ti(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ti(t)?t:t+""}Qo(ei,"ID",$o);var hi="booster_invulnerability_default",yi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oi(e,t)}(i,e);var t,r,n,o=ii(i);function i(){var e;ri(this,i);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return ci(si(e=o.call.apply(o,[this].concat(r))),"id",hi),ci(si(e),"iconId",4),e}return t=i,(r=[{key:"activateBoosterFor",value:function(e){}}])&&ni(t.prototype,r),n&&ni(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(wo);function pi(e){return pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pi(e)}function vi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function di(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Oi(n.key),n)}}function bi(e,t){return bi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},bi(e,t)}function mi(e){var t=ki();return function(){var r,n=Pi(e);if(t){var o=Pi(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return wi(this,r)}}function wi(e,t){if(t&&("object"==pi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return gi(e)}function gi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ki(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ki=function(){return!!e})()}function Pi(e){return Pi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Pi(e)}function Si(e,t,r){return(t=Oi(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Oi(e){var t=function(e,t){if("object"!=pi(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=pi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==pi(t)?t:t+""}ci(yi,"ID",hi);var ji="booster_reaper_default",xi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bi(e,t)}(i,e);var t,r,n,o=mi(i);function i(){var e;vi(this,i);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Si(gi(e=o.call.apply(o,[this].concat(r))),"id",ji),Si(gi(e),"iconId",5),Si(gi(e),"gatheringRadius",25),Si(gi(e),"extraRadiusMultiplier",1.1),Si(gi(e),"preventSpawnIfGatheredPercentageAbove",60),e}return t=i,(r=[{key:"spawnConditionsMet",value:function(e){return e.collectedCrops/e.totalCrops<this.preventSpawnIfGatheredPercentageAbove/100}},{key:"radius",get:function(){var e=this.adsBased?this.extraRadiusMultiplier:1;return this.gatheringRadius*e}}])&&di(t.prototype,r),n&&di(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(wo);function _i(e){return _i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_i(e)}function Ti(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bi(e,t){return Bi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Bi(e,t)}function Ci(e){var t=Di();return function(){var r,n=Ri(e);if(t){var o=Ri(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Ai(this,r)}}function Ai(e,t){if(t&&("object"==_i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Mi(e)}function Mi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Di(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Di=function(){return!!e})()}function Ri(e){return Ri=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ri(e)}function Ei(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=_i(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_i(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Si(xi,"ID",ji);var Ii="booster_sawReel_default",Li=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Bi(e,t)}(r,e);var t=Ci(r);function r(){var e;Ti(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return Ei(Mi(e=t.call.apply(t,[this].concat(o))),"id",Ii),Ei(Mi(e),"iconId",6),e}return r}(wo);function Fi(e){return Fi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fi(e)}function zi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gi(e,t){return Gi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Gi(e,t)}function Vi(e){var t=Hi();return function(){var r,n=Xi(e);if(t){var o=Xi(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Zi(this,r)}}function Zi(e,t){if(t&&("object"==Fi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ni(e)}function Ni(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hi(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Hi=function(){return!!e})()}function Xi(e){return Xi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Xi(e)}function Ki(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=Fi(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Fi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Fi(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Ei(Li,"ID",Ii);var Wi="booster_companion_default",Ui=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Gi(e,t)}(r,e);var t=Vi(r);function r(){var e;zi(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return Ki(Ni(e=t.call.apply(t,[this].concat(o))),"id",Wi),Ki(Ni(e),"iconId",7),Ki(Ni(e),"rotationRadius",10),Ki(Ni(e),"rotationSpeed",1.5),Ki(Ni(e),"gatheringRadius",5),e}return r}(wo);function Ji(e){return Ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ji(e)}function qi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qi(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ia(n.key),n)}}function Yi(e,t){return Yi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Yi(e,t)}function $i(e){var t=ra();return function(){var r,n=na(e);if(t){var o=na(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ea(this,r)}}function ea(e,t){if(t&&("object"==Ji(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ta(e)}function ta(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ra(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ra=function(){return!!e})()}function na(e){return na=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},na(e)}function oa(e,t,r){return(t=ia(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ia(e){var t=function(e,t){if("object"!=Ji(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Ji(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ji(t)?t:t+""}Ki(Ui,"ID",Wi);var aa="booster_bonusPlants_default",sa=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yi(e,t)}(i,e);var t,r,n,o=$i(i);function i(){var e;qi(this,i);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return oa(ta(e=o.call.apply(o,[this].concat(r))),"id",aa),oa(ta(e),"iconId",8),oa(ta(e),"equivalentInResult",3),oa(ta(e),"adsBonusEquivalent",1),e}return t=i,(r=[{key:"trucksAmount",get:function(){var e=this.equivalentInResult;return this.adsBased&&(e+=this.adsBonusEquivalent),e}}])&&Qi(t.prototype,r),n&&Qi(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(wo);function ua(e){return ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ua(e)}function la(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ca(e,t){return ca=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ca(e,t)}function fa(e){var t=pa();return function(){var r,n=va(e);if(t){var o=va(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ha(this,r)}}function ha(e,t){if(t&&("object"==ua(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ya(e)}function ya(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pa(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(pa=function(){return!!e})()}function va(e){return va=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},va(e)}function da(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=ua(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ua(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ua(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}oa(sa,"ID",aa);var ba="booster_freezeBooster_default",ma=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ca(e,t)}(r,e);var t=fa(r);function r(){var e;la(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return da(ya(e=t.call.apply(t,[this].concat(o))),"id",ba),da(ya(e),"iconId",9),e}return r}(wo);function wa(e){return wa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wa(e)}function ga(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function ka(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){ga(i,n,o,a,s,"next",e)}function s(e){ga(i,n,o,a,s,"throw",e)}a(void 0)}))}}function Pa(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ja(n.key),n)}}function Sa(e,t,r){return t&&Pa(e.prototype,t),r&&Pa(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Oa(e,t,r){return(t=ja(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ja(e){var t=function(e,t){if("object"!=wa(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=wa(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==wa(t)?t:t+""}da(ma,"ID",ba);var xa=new Map,_a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Oa(this,"isActive",!1),Oa(this,"harvester",null),Oa(this,"boosterData",void 0),Oa(this,"durationLeft",1/0),Oa(this,"hasTimer",!0),this.boosterData=t,this.durationLeft=this.duration}var t,r;return Sa(e,[{key:"id",get:function(){var e;return null===(e=this.boosterData)||void 0===e?void 0:e.id}},{key:"isExpired",get:function(){return this.durationLeft<=0}},{key:"adsBased",get:function(){var e;return!!(null===(e=this.boosterData)||void 0===e?void 0:e.adsBased)}},{key:"duration",get:function(){var e;return(null===(e=this.boosterData)||void 0===e?void 0:e.getDuration(this.adsBased))||0}},{key:"durationPercent",get:function(){return x.N.Clamp((this.duration-this.durationLeft)/this.duration,0,1)}}],[{key:"registerClass",value:function(e){xa.set(e.ID,e)}},{key:"create",value:function(e){return new(xa.get(e.id)||this)(e)}}]),Sa(e,[{key:"tick",value:function(e){this.isActive&&(this.durationLeft-=.001*e,this.durationLeft<=0&&(this.expire(),this.harvester&&(this.hasTimer&&kr.X.emit("boosterEnd",this),this.endBoosterEffect(),this.destroyVFX(),this.harvester=null)),this.isExpired||this.updateBoosterEffect(e))}},{key:"expire",value:function(){this.durationLeft=0,this.isActive=!1}},{key:"preload",value:(r=ka(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"applyToHarvester",value:(t=ka(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.harvester=t,this.harvester.isBot?this.hasTimer=!1:(Or.Z.play("booster-pick-up"),Or.Z.play("booster-take"),Or.Z.play("booster-use")),e.next=4,this.preload();case 4:return this.durationLeft=this.duration,e.next=7,this.startBoosterEffect();case 7:return e.next=9,this.createVFX();case 9:this.isActive=!0,this.hasTimer&&kr.X.emit("boosterStart",this);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"renewFromBooster",value:function(e){this.durationLeft=e.duration}},{key:"startBoosterEffect",value:function(){}},{key:"updateBoosterEffect",value:function(e){}},{key:"endBoosterEffect",value:function(){}},{key:"createVFX",value:function(){}},{key:"destroyVFX",value:function(){this._vfx&&this._vfx.removeFromParent&&this._vfx.removeFromParent(),this._vfx=null}},{key:"stopSound",value:function(){this.sound&&(this.sound.stop(),this.sound.workEnd=!0,this.sound=null)}}]),e}();function Ta(e){return Ta="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ta(e)}function Ba(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ca(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fa(n.key),n)}}function Aa(e,t){return Aa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Aa(e,t)}function Ma(e){var t=Ea();return function(){var r,n=Ia(e);if(t){var o=Ia(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Da(this,r)}}function Da(e,t){if(t&&("object"==Ta(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ra(e)}function Ra(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ea(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ea=function(){return!!e})()}function Ia(e){return Ia=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ia(e)}function La(e,t,r){return(t=Fa(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fa(e){var t=function(e,t){if("object"!=Ta(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Ta(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ta(t)?t:t+""}var za=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Aa(e,t)}(s,e);var t,r,i,a=Ma(s);function s(){var e;Ba(this,s);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return La(Ra(e=a.call.apply(a,[this].concat(r))),"_vfx",null),La(Ra(e),"_vfxTween",null),e}return t=s,(r=[{key:"startBoosterEffect",value:function(){this.harvester.overrideReelLevel=this.boosterData.reelLevel,this.harvester.setReel(this.harvester.overrideReelLevel),this.harvester.isBot||Or.Z.play("booster-grow-up")}},{key:"updateBoosterEffect",value:function(e){}},{key:"endBoosterEffect",value:function(){this.harvester.overrideReelLevel=-1,this.harvester.setReel(),this.harvester=null}},{key:"createVFX",value:function(){var e=this;if(!this._vfx){var t=this.harvester.view.reel._rotationChildren[0];if(t){var r=new n.MeshBasicMaterial({color:16776960,transparent:!0,opacity:0});this._vfx=new n.Mesh(new n.CylinderGeometry(75,75,550),r),this._vfx.rotation.z=.5*Math.PI,t.add(this._vfx),this._vfxTween=new o.ZP.Tween(r).to({opacity:.5},1500).onComplete((function(){return e._startVFXPulsation()})).start()}}}},{key:"_startVFXPulsation",value:function(){this._vfxTween=new o.ZP.Tween(this._vfx.scale).to({x:1.5,z:1.5},500).repeat(1/0).yoyo(!0).start()}},{key:"destroyVFX",value:function(){this._vfxTween&&(this._vfxTween.stop(),o.ZP.remove(this._vfxTween),this._vfxTween=null);var e=this._vfx;e&&new o.ZP.Tween(e.material).to({opacity:0},1500).onComplete((function(){return e.removeFromParent()})).start(),this._vfx=null}}])&&Ca(t.prototype,r),i&&Ca(t,i),Object.defineProperty(t,"prototype",{writable:!1}),s}(_a);function Ga(e){return Ga="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ga(e)}function Va(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function Za(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){Va(i,n,o,a,s,"next",e)}function s(e){Va(i,n,o,a,s,"throw",e)}a(void 0)}))}}function Na(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ha(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qa(n.key),n)}}function Xa(e,t){return Xa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Xa(e,t)}function Ka(e){var t=Ua();return function(){var r,n=Ja(e);if(t){var o=Ja(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Wa(this,r)}}function Wa(e,t){if(t&&("object"==Ga(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ua(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ua=function(){return!!e})()}function Ja(e){return Ja=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ja(e)}function qa(e){var t=function(e,t){if("object"!=Ga(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Ga(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ga(t)?t:t+""}La(za,"ID",Co.ID);var Qa,Ya,$a,es=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xa(e,t)}(f,e);var t,r,i,a,u,l,c=Ka(f);function f(){return Na(this,f),c.apply(this,arguments)}return t=f,r=[{key:"startBoosterEffect",value:(l=Za(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.harvester.speedMultiplier=this.boosterData.multiplierValue,this.stopSound(),this.harvester.isBot){e.next=8;break}return e.next=5,Or.Z.play("booster-drone",!0);case 5:this.sound=e.sent,console.log("!! this.sound = ",this.sound),this.sound&&this.sound._rate&&(this.sound.rate(1.5),kr.X.emit("startSound",this.sound));case 8:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"updateBoosterEffect",value:function(e){}},{key:"endBoosterEffect",value:function(){this.harvester.speedMultiplier=1,this.stopSound()}},{key:"preload",value:(u=Za(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([s.yG("textures/vfx/speed-trail")]));case 1:case"end":return e.stop()}}),e)}))),function(){return u.apply(this,arguments)})},{key:"createVFX",value:(a=Za(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._vfx){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.preload();case 4:t=new n.MeshBasicMaterial({color:16750848,transparent:!0,opacity:.5,map:s.Hp("textures/vfx/speed-trail")}),r=new n.MeshBasicMaterial({transparent:!0,opacity:0}),this._vfx=new n.Mesh(new n.BoxGeometry(14,.2,7),[r,r,t,r,r,r]),this._vfx.scale.setScalar(0),this._vfx.position.z=-4,this._vfx.rotation.y=.5*Math.PI,this.harvester.add(this._vfx),new o.ZP.Tween(this._vfx.scale).to({x:1,y:1,z:1},500).easing(o.ZP.Easing.Cubic.In).start();case 12:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"destroyVFX",value:function(){var e=this._vfx;this._vfx=null,e&&new o.ZP.Tween(e.scale).to({x:0,y:0,z:0},500).onComplete((function(){return e.removeFromParent()})).start()}}],r&&Ha(t.prototype,r),i&&Ha(t,i),Object.defineProperty(t,"prototype",{writable:!1}),f}(_a);function ts(e){return ts="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ts(e)}function rs(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=is(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function ns(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||is(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function os(e){return function(e){if(Array.isArray(e))return as(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||is(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function is(e,t){if(e){if("string"==typeof e)return as(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?as(e,t):void 0}}function as(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function ss(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function us(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ds(n.key),n)}}function ls(e,t){return ls=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ls(e,t)}function cs(e){var t=ys();return function(){var r,n=ps(e);if(t){var o=ps(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return fs(this,r)}}function fs(e,t){if(t&&("object"==ts(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return hs(e)}function hs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ys(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ys=function(){return!!e})()}function ps(e){return ps=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ps(e)}function vs(e,t,r){return(t=ds(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ds(e){var t=function(e,t){if("object"!=ts(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ts(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ts(t)?t:t+""}Qa=es,Ya="ID",$a=Vo.ID,(Ya=qa(Ya))in Qa?Object.defineProperty(Qa,Ya,{value:$a,enumerable:!0,configurable:!0,writable:!0}):Qa[Ya]=$a;var bs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ls(e,t)}(r,e);var t=cs(r);function r(){var e;ss(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return vs(hs(e=t.call.apply(t,[this].concat(o))),"hasTimer",!1),e}return function(e,t,r){t&&us(e.prototype,t),r&&us(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"startBoosterEffect",value:function(){this.harvester.isBot||Or.Z.play("booster-wagon"),this.harvester.amountPerTruckMultiplier>1||(this.harvester.amountPerTruckMultiplier=this.boosterData.multiplier,this._initX2Mode(),this.harvester.isBot||this.harvester.level.boosterSpawner.removeBooster(this.id))}},{key:"_initX2Mode",value:function(){var e,t=this.harvester.trails,r=this.harvester.initialAmountPerTruck,n=new Map,o=function(e,t){return n.set(e,t+(n.get(e)||0))},i=function(e){return(os(n).find((function(t){var r=ns(t,2);r[0];return r[1]>=e}))||[]).shift()},a=rs(this.harvester.gatheredCrops);try{for(a.s();!(e=a.n()).done;){var s=ns(e.value,2);o(s[0],s[1])}}catch(e){a.e(e)}finally{a.f()}var u,l=rs(t);try{for(l.s();!(u=l.n()).done;){o(u.value.cropType,r)}}catch(e){l.e(e)}finally{l.f()}r=this.harvester.amountPerTruck;for(var c=null,f=0;f<t.length;f++){var h=t[f],y=h.cropType,p=n.get(y),v=!1;if(p<r&&(y=i(r),p=n.get(y)||0,v=!0),!y){c=t.splice(f);break}o(y,-r),v&&h.setHarvestType(y),h.x2=!0,h.doX2UpAnimation()}var d,b=rs(c);try{for(b.s();!(d=b.n()).done;){d.value.doX2DownAnimation().then((function(e){return e.handleDestroy()}))}}catch(e){b.e(e)}finally{b.f()}var m,w=rs(n);try{for(w.s();!(m=w.n()).done;){var g=ns(m.value,2),k=g[0],P=g[1];this.harvester.gatheredCrops.clear(),P>0&&this.harvester.gatheredCrops.set(k,P)}}catch(e){w.e(e)}finally{w.f()}}},{key:"updateBoosterEffect",value:function(e){}},{key:"endBoosterEffect",value:function(){}}]),r}(_a);function ms(e){return ms="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ms(e)}function ws(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function gs(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){ws(i,n,o,a,s,"next",e)}function s(e){ws(i,n,o,a,s,"throw",e)}a(void 0)}))}}function ks(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ps(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ts(n.key),n)}}function Ss(e,t){return Ss=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ss(e,t)}function Os(e){var t=xs();return function(){var r,n=_s(e);if(t){var o=_s(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return js(this,r)}}function js(e,t){if(t&&("object"==ms(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function xs(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(xs=function(){return!!e})()}function _s(e){return _s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_s(e)}function Ts(e){var t=function(e,t){if("object"!=ms(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ms(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ms(t)?t:t+""}vs(bs,"ID",ei.ID);var Bs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ss(e,t)}(a,e);var t,r,i=Os(a);function a(){return ks(this,a),i.apply(this,arguments)}return function(e,t,r){t&&Ps(e.prototype,t),r&&Ps(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(a,[{key:"startBoosterEffect",value:function(){this.harvester.setInvulnerable(!0,1/0),this.stopSound(),this.harvester.isBot||(this.sound=Or.Z.play("booster-shield",!0),kr.X.emit("startSound",this.sound))}},{key:"updateBoosterEffect",value:function(e){}},{key:"endBoosterEffect",value:function(){this.harvester.setInvulnerable(!1),this.stopSound()}},{key:"preload",value:(r=gs(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([s.yG("textures/vfx/unbreakable")]));case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"createVFX",value:(t=gs(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._vfx){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.preload();case 4:t=s.Hp("textures/vfx/unbreakable"),r=new n.MeshBasicMaterial({map:t,transparent:!0,opacity:0}),this._vfx=new n.Mesh(new n.SphereGeometry(12),r),this.harvester.add(this._vfx),new o.ZP.Tween(r).to({opacity:1},1e3).onUpdate((function(){return r.needsUpdate=!0})).start(),new o.ZP.Tween(this._vfx.scale).to({x:1,y:1,z:1},2500).easing(o.ZP.Easing.Cubic.In).start();case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"destroyVFX",value:function(){var e=this._vfx;this._vfx=null,e&&new o.ZP.Tween(e.material).to({opacity:0},500).onUpdate((function(){return e.material.needsUpdate=!0})).onComplete((function(){return e.removeFromParent()})).start()}}]),a}(_a);function Cs(e){return Cs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cs(e)}function As(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function Ms(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){As(i,n,o,a,s,"next",e)}function s(e){As(i,n,o,a,s,"throw",e)}a(void 0)}))}}function Ds(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rs(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zs(n.key),n)}}function Es(e,t){return Es=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Es(e,t)}function Is(e){var t=zs();return function(){var r,n=Gs(e);if(t){var o=Gs(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Ls(this,r)}}function Ls(e,t){if(t&&("object"==Cs(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Fs(e)}function Fs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zs(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(zs=function(){return!!e})()}function Gs(e){return Gs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Gs(e)}function Vs(e,t,r){return(t=Zs(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zs(e){var t=function(e,t){if("object"!=Cs(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Cs(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Cs(t)?t:t+""}!function(e,t,r){(t=Ts(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(Bs,"ID",yi.ID);var Ns=new n.MeshBasicMaterial({transparent:!0,opacity:0}),Hs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Es(e,t)}(u,e);var t,r,i=Is(u);function u(){var e;Ds(this,u);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Vs(Fs(e=i.call.apply(i,[this].concat(r))),"hasTimer",!1),e}return function(e,t,r){t&&Rs(e.prototype,t),r&&Rs(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(u,[{key:"startBoosterEffect",value:function(){var e=this.harvester,t=new a.Cd(e.position.x,e.position.z,this.boosterData.radius);e.harvestShapes.set(this.id,t),this.durationLeft=1}},{key:"updateBoosterEffect",value:function(e){}},{key:"endBoosterEffect",value:function(){this.harvester.harvestShapes.delete(this.id)}},{key:"preload",value:(r=Ms(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([s.yG("textures/vfx/scythe")]));case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"createVFX",value:(t=Ms(regeneratorRuntime.mark((function e(){var t,r,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._vfx){e.next=2;break}return e.abrupt("return");case 2:this._vfx=new n.Group,this.harvester.add(this._vfx),t=new n.MeshBasicMaterial({map:s.Hp("textures/vfx/scythe"),transparent:!0,opacity:.5}),r=new n.Mesh(new n.BoxGeometry(2*this.boosterData.radius,.2,2*this.boosterData.radius),[Ns,Ns,t,Ns,Ns,Ns]),this._vfx.add(r),new o.ZP.Tween(this._vfx.rotation).to({y:4*-Math.PI},500).onComplete((function(){i._vfx.removeFromParent()})).start();case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"destroyVFX",value:function(){}}]),u}(_a);function Xs(e){return Xs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xs(e)}function Ks(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function Ws(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){Ks(i,n,o,a,s,"next",e)}function s(e){Ks(i,n,o,a,s,"throw",e)}a(void 0)}))}}function Us(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Js(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Js(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function Js(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function qs(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Qs(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,iu(n.key),n)}}function Ys(e,t){return Ys=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ys(e,t)}function $s(e){var t=ru();return function(){var r,n=nu(e);if(t){var o=nu(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return eu(this,r)}}function eu(e,t){if(t&&("object"==Xs(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return tu(e)}function tu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ru(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ru=function(){return!!e})()}function nu(e){return nu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},nu(e)}function ou(e,t,r){return(t=iu(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iu(e){var t=function(e,t){if("object"!=Xs(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Xs(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Xs(t)?t:t+""}Vs(Hs,"ID",xi.ID);new n.Vector3;var au=new n.Vector3(0,0,7),su=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ys(e,t)}(i,e);var t,r,o=$s(i);function i(){var e;qs(this,i);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return ou(tu(e=o.call.apply(o,[this].concat(r))),"sawCenter",new n.Vector3),e}return function(e,t,r){t&&Qs(e.prototype,t),r&&Qs(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(i,[{key:"startBoosterEffect",value:function(){this.harvester.setSaw(!0),this.stopSound(),this.harvester.isBot||(this.sound=Or.Z.play("booster-saw-loop",!0),kr.X.emit("startSound",this.sound))}},{key:"updateBoosterEffect",value:function(e){var t=this;this.harvester.localToWorld(this.sawCenter.copy(au));var r,n=1/0,o=null,i=!1,a=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,i=t.sawCenter.distanceToSquared(e.position);return!(i>r)&&(!o||n>i?(o=e,n=i,e):void 0)},s=Us(this.harvester.level.actors);try{for(s.s();!(r=s.n()).done;){var u=r.value;if(!u.harvester||u.isDead)return;u.harvester!==this.harvester&&a(u.harvester,49)&&(i=!1);var l,c=Us(u.harvester.trails);try{for(c.s();!(l=c.n()).done;){a(l.value,16)&&(i=!0)}}catch(e){c.e(e)}finally{c.f()}}}catch(e){s.e(e)}finally{s.f()}o&&(i?this.harvester.level._handleTrailCollision(this.harvester,o):this.harvester.level._handleActorsCollision(this.harvester,o))}},{key:"endBoosterEffect",value:function(){this.harvester.setSaw(!1),this.stopSound()}},{key:"preload",value:(r=Ws(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([]));case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"createVFX",value:(t=Ws(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._vfx){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.preload();case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"destroyVFX",value:function(){this._vfx;this._vfx=null}}]),i}(_a);function uu(e){return uu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uu(e)}function lu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cu(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,mu(n.key),n)}}function fu(e,t){return fu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},fu(e,t)}function hu(e){var t=vu();return function(){var r,n=du(e);if(t){var o=du(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return yu(this,r)}}function yu(e,t){if(t&&("object"==uu(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return pu(e)}function pu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vu(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(vu=function(){return!!e})()}function du(e){return du=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},du(e)}function bu(e,t,r){return(t=mu(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mu(e){var t=function(e,t){if("object"!=uu(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=uu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==uu(t)?t:t+""}ou(su,"ID",Li.ID);var wu=new n.Vector3,gu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fu(e,t)}(r,e);var t=hu(r);function r(){var e;lu(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return bu(pu(e=t.call.apply(t,[this].concat(o))),"drone",void 0),bu(pu(e),"droneContainer",void 0),bu(pu(e),"shape",new a.Cd(1/0,1/0,0)),e}return function(e,t,r){t&&cu(e.prototype,t),r&&cu(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"startBoosterEffect",value:function(){this.shape.radius=this.boosterData.gatheringRadius,this.harvester.harvestShapes.set(this.id,this.shape),this.stopSound(),this.harvester.isBot||(this.sound=Or.Z.play("booster-drone",!0),kr.X.emit("startSound",this.sound))}},{key:"updateBoosterEffect",value:function(e){if(this.drone&&this.harvester){this.droneContainer.rotation.y+=Math.PI*this.boosterData.rotationSpeed*e/1e3;var t=this.drone.localToWorld(wu.set(0,0,0)),r=t.x,n=t.z;this.shape.x=r,this.shape.y=n}}},{key:"endBoosterEffect",value:function(){this.harvester.harvestShapes.delete(this.id),this.stopSound()}},{key:"createVFX",value:function(){this.droneContainer=new n.Group,this.droneContainer.position.z=5,this.harvester.add(this.droneContainer),this.drone=this.harvester.view.createDrone(),this.drone.scale.setScalar(.01),this.drone.position.set(this.boosterData.rotationRadius,5,0),this.droneContainer.add(this.drone)}},{key:"destroyVFX",value:function(){var e=this.drone,t=this.droneContainer;this.drone=null,this.droneContainer=null,t&&(e?new o.ZP.Tween(e.position).to({x:100,y:50,z:100},2e3).onComplete((function(){t.removeFromParent()})).start():t.removeFromParent())}}]),r}(_a);function ku(e){return ku="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ku(e)}function Pu(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function Su(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){Pu(i,n,o,a,s,"next",e)}function s(e){Pu(i,n,o,a,s,"throw",e)}a(void 0)}))}}function Ou(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ju(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Du(n.key),n)}}function xu(e,t){return xu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xu(e,t)}function _u(e){var t=Cu();return function(){var r,n=Au(e);if(t){var o=Au(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Tu(this,r)}}function Tu(e,t){if(t&&("object"==ku(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Bu(e)}function Bu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Cu(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Cu=function(){return!!e})()}function Au(e){return Au=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Au(e)}function Mu(e,t,r){return(t=Du(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Du(e){var t=function(e,t){if("object"!=ku(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ku(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ku(t)?t:t+""}bu(gu,"ID",Ui.ID);var Ru,Eu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xu(e,t)}(a,e);var t,r,i=_u(a);function a(){var e;Ou(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Mu(Bu(e=i.call.apply(i,[this].concat(r))),"hasTimer",!1),e}return function(e,t,r){t&&ju(e.prototype,t),r&&ju(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(a,[{key:"preload",value:(r=Su(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([s.yG("textures/vfx/txt-farmer-1"),s.yG("textures/vfx/txt-farmer-2")]));case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"startBoosterEffect",value:function(){var e=this.harvester,t=e.initialAmountPerTruck,r=e.level.fields.map((function(e){return e.plantData.type}));r=r[~~(r.length*Math.random())];var n=this.boosterData.trucksAmount*t;e.trimTrailToExact(),e.gatherHarvestable(r,n),this.durationLeft=1/0,e.isBot||Or.Z.play("booster-sheaf")}},{key:"updateBoosterEffect",value:function(e){}},{key:"endBoosterEffect",value:function(){}},{key:"createVFX",value:(t=Su(regeneratorRuntime.mark((function e(){var t,r,i,a,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._vfx){e.next=2;break}return e.abrupt("return");case 2:for(t=[s.Hp("textures/vfx/txt-farmer-1"),s.Hp("textures/vfx/txt-farmer-2")],r=3e3,i=function(e){var i=t[e%t.length],a=new n.MeshBasicMaterial({map:i,transparent:!0,opacity:.75,color:16776960}),s=new n.Mesh(new n.SphereGeometry(11+2*e,32,32),a);s.rotation.y=2*Math.PI*Math.random(),u.harvester.add(s),new o.ZP.Tween(a).to({opacity:0},750).delay(1800).start();var l=2+~~(3*Math.random());new o.ZP.Tween(s.rotation).to({y:2*Math.PI*l},r).easing(o.ZP.Easing.Quadratic.InOut).onComplete((function(){return s.removeFromParent()})).start()},a=0;a<3;a++)i(a);this.durationLeft=1;case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"destroyVFX",value:function(){}}]),a}(_a);function Iu(e){return Iu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Iu(e)}function Lu(e){return function(e){if(Array.isArray(e))return Vu(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Gu(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fu(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Gu(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function zu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||Gu(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gu(e,t){if(e){if("string"==typeof e)return Vu(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Vu(e,t):void 0}}function Vu(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Zu(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function Nu(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){Zu(i,n,o,a,s,"next",e)}function s(e){Zu(i,n,o,a,s,"throw",e)}a(void 0)}))}}function Hu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xu(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tl(n.key),n)}}function Ku(e,t,r){return t&&Xu(e.prototype,t),r&&Xu(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wu(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Uu(e,t)}function Uu(e,t){return Uu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Uu(e,t)}function Ju(e){var t=Yu();return function(){var r,n=$u(e);if(t){var o=$u(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return qu(this,r)}}function qu(e,t){if(t&&("object"==Iu(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Qu(e)}function Qu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yu(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Yu=function(){return!!e})()}function $u(e){return $u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$u(e)}function el(e,t,r){return(t=tl(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tl(e){var t=function(e,t){if("object"!=Iu(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Iu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Iu(t)?t:t+""}Mu(Eu,"ID",sa.ID);var rl=function(e){Wu(l,e);var t,r,i,a,u=Ju(l);function l(){var e;Hu(this,l);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return el(Qu(e=u.call.apply(u,[this].concat(r))),"_ice",void 0),e}return Ku(l,[{key:"preload",value:(a=Nu(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([s.yG("textures/vfx/txt-fx-frost-ice"),s.u7("vfx/frost-ice")]).then((function(e){var t=zu(e,2),r=t[0],o=t[1];Ru=Ru||new n.MeshBasicMaterial({map:r,transparent:!0,opacity:.5}),o.traverse((function(e){e.material&&(e.material.map=r,e.material.transparent=!0,e.material.opacity=.95)}))})));case 1:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})},{key:"init",value:(i=Nu(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.preload();case 2:this._ice=s.PD("vfx/frost-ice"),this.scale.setScalar(.01),this._ice.scale.setScalar(0),this._ice.position.z=100,this.add(this._ice);case 7:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"show",value:(r=Nu(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return e.abrupt("return",new Promise((function(e){new o.ZP.Tween(t._ice.scale).to({x:1,y:1,z:1},300).easing(o.ZP.Easing.Quadratic.Out).onComplete(e).start()})));case 3:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"hide",value:(t=Nu(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._ice){e.next=2;break}return e.abrupt("return",this.removeFromParent());case 2:return e.abrupt("return",new Promise((function(e){new o.ZP.Tween(t._ice.scale).to({x:0,y:0,z:0},500).onComplete((function(){t.removeFromParent(),e()})).start()})));case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),l}(n.Group),nl=new n.Vector3,ol=function(e){Wu(r,e);var t=Ju(r);function r(){var e;return Hu(this,r),el(Qu(e=t.call(this,new n.SpriteMaterial({map:s.Hp("textures/vfx/snowflake_tex"),transparent:!0}))),"isDead",!1),el(Qu(e),"_velocity",new n.Vector3(0,0,0)),el(Qu(e),"_angularVelocity",0),e._velocity.y=-(5+5*Math.random()),e._angularVelocity=(.5-Math.random())*Math.PI,e}return Ku(r,[{key:"tick",value:function(e){this.isDead||(this.position.add(nl.copy(this._velocity).multiplyScalar(e)),this.rotation.y+=this._angularVelocity*e,this.position.y<-1&&(this.removeFromParent(),this.isDead=!0))}}]),r}(n.Sprite),il=function(e){Wu(r,e);var t=Ju(r);function r(){var e;Hu(this,r),el(Qu(e=t.call(this)),"isDead",!1),el(Qu(e),"_velocity",new n.Vector3(0,0,0)),el(Qu(e),"_sprite",void 0);var o=2+10*Math.random(),i=2*Math.PI*Math.random(),a=70+50*Math.random();return e._sprite=new n.Mesh(new n.PlaneGeometry(o,o),new n.MeshBasicMaterial({map:s.Hp("textures/vfx/triangle_soft_tex"),transparent:!0,opacity:1,side:n.DoubleSide})),e._sprite.rotation.y=.5*Math.PI,e.add(e._sprite),e._velocity.set(1,0,0).multiplyScalar(a).applyAxisAngle(nl.set(0,-1,0),i),e.lookAt(e._velocity),e}return Ku(r,[{key:"tick",value:function(e){if(!this.isDead&&this._sprite){var t=this._sprite.material,r=x.N.Clamp(t.opacity-.5*e,0,1);t.opacity=r,this.position.add(nl.copy(this._velocity).multiplyScalar(e)),0===r&&(this.isDead=!0,this.removeFromParent())}}}]),r}(n.Group),al=function(e){Wu(u,e);var t,r,i,a=Ju(u);function u(){var e;return Hu(this,u),el(Qu(e=a.call(this)),"isDead",!1),el(Qu(e),"_sphere",void 0),el(Qu(e),"_sphere2",void 0),el(Qu(e),"_particles",void 0),e.renderOrder=1,e}return Ku(u,[{key:"preload",value:(i=Nu(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([s.yG("textures/vfx/snowflake_tex"),s.yG("textures/vfx/ring_tex"),s.yG("textures/vfx/ring_shockwave_tex"),s.yG("textures/vfx/triangle_soft_tex")]));case 1:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)})},{key:"init",value:(r=Nu(regeneratorRuntime.mark((function e(){var t,r,o,i,a,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new n.MeshBasicMaterial({color:16777215,transparent:!0,opacity:0}),r=new n.SphereGeometry(12,32,32),this._sphere=new n.Mesh(r,t),this.add(this._sphere),e.next=6,this.preload();case 6:for(o=new Set,i=0;i<20;i++)a=new ol,this.add(a),a.position.set(30*(.5-Math.random()),5+20*Math.random(),30*(.5-Math.random())),a.scale.setScalar(1+1.5*Math.random()),o.add(a);for(s=0;s<20;s++)u=new il,this.add(u),u.position.copy(u._velocity).normalize().multiplyScalar(.5),o.add(u);this._particles=o;case 10:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"run",value:(t=Nu(regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:t=1e3,this._sphere.material.opacity=0,this._sphere.scale.setScalar(1),Promise.all([new Promise((function(e){return new o.ZP.Tween(r._sphere.scale).to({x:10,y:10,z:10},t).easing(o.ZP.Easing.Quadratic.In).onComplete(e).start()})),new Promise((function(e){return new o.ZP.Tween(r._sphere.material).to({opacity:.5},300).easing(o.ZP.Easing.Quadratic.In).onComplete((function(){return new o.ZP.Tween(r._sphere.material).to({opacity:0},300).easing(o.ZP.Easing.Quadratic.In).onComplete(e).start()})).start()}))]).then((function(){r._sphere.removeFromParent(),r._sphere=null}));case 6:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"complete",value:function(){this.isDead=!0,this.removeFromParent(),this._particles&&this._particles.clear()}},{key:"tick",value:function(e){if(!this.isDead&&this._particles){var t,r=Fu(this._particles);try{for(r.s();!(t=r.n()).done;){var n=t.value;n.tick(.001*e),n.isDead&&this._particles.delete(n)}}catch(e){r.e(e)}finally{r.f()}0===this._particles.size&&this.complete()}}}]),u}(n.Group),sl=function(e){Wu(i,e);var t,r,n,o=Ju(i);function i(){var e;Hu(this,i);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return el(Qu(e=o.call.apply(o,[this].concat(r))),"targets",[]),el(Qu(e),"_targetsIce",null),el(Qu(e),"_explosion",null),e}return Ku(i,[{key:"startBoosterEffect",value:function(){if(!this.harvester.isBot){this.targets.splice(0);var e,t=Fu(this.harvester.level.actors);try{for(t.s();!(e=t.n()).done;){var r=e.value;r.isBot&&!r.isDead&&r.harvester&&r.harvester!==this.harvester&&this.targets.push(r.harvester)}}catch(e){t.e(e)}finally{t.f()}var n,o=Fu(this.targets);try{for(o.s();!(n=o.n()).done;){n.value.speedMultiplier=0}}catch(e){o.e(e)}finally{o.f()}}}},{key:"updateBoosterEffect",value:function(e){this._explosion&&(this._explosion.tick(e),this._explosion.isDead&&(this._explosion=null))}},{key:"endBoosterEffect",value:function(){if(!this.harvester.isBot){var e,t=Fu(this.targets);try{for(t.s();!(e=t.n()).done;){e.value.speedMultiplier=1}}catch(e){t.e(e)}finally{t.f()}}}},{key:"_createIcedTargets",value:(n=Nu(regeneratorRuntime.mark((function e(){var t,r,n,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._targetsIce){e.next=2;break}return e.abrupt("return");case 2:this._targetsIce=[],t=Lu(this.targets),r=Fu(t);try{for(r.s();!(n=r.n()).done;)o=n.value,i=new rl,o.add(i),this._targetsIce.push(i),i.show().then((function(){}))}catch(e){r.e(e)}finally{r.f()}Or.Z.play("booster-freeze");case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"_runExplosion",value:(r=Nu(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.harvester.parent){e.next=2;break}return e.abrupt("return");case 2:this._explosion&&this._explosion.complete(),this._explosion=new al,this._explosion.position.copy(this.harvester.position),this.harvester.level.add(this._explosion),this._explosion.run().then((function(e){})),Or.Z.play("booster-freeze-2");case 8:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"createVFX",value:(t=Nu(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.harvester.isBot){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",Promise.all([this._runExplosion(),this._createIcedTargets()]));case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"destroyVFX",value:function(){if(this._targetsIce){var e,t=Fu(this._targetsIce);try{for(t.s();!(e=t.n()).done;){e.value.hide()}}catch(e){t.e(e)}finally{t.f()}}this._targetsIce=null,this._explosion&&(this._explosion.complete(),this._explosion=null)}},{key:"targets",get:function(){var e,t=[],r=Fu(this.harvester.level.actors);try{for(r.s();!(e=r.n()).done;){var n=e.value;n.isBot&&!n.isDead&&n.harvester&&n.harvester!==this.harvester&&t.push(n.harvester)}}catch(e){r.e(e)}finally{r.f()}return t}}]),i}(_a);function ul(e){return wo.create(e)}function ll(e){return _a.create(e)}function cl(e){return cl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cl(e)}function fl(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function hl(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){fl(i,n,o,a,s,"next",e)}function s(e){fl(i,n,o,a,s,"throw",e)}a(void 0)}))}}function yl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pl(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sl(n.key),n)}}function vl(e,t,r){return t&&pl(e.prototype,t),r&&pl(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dl(e,t){return dl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},dl(e,t)}function bl(e){var t=gl();return function(){var r,n=kl(e);if(t){var o=kl(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return ml(this,r)}}function ml(e,t){if(t&&("object"==cl(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return wl(e)}function wl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gl(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(gl=function(){return!!e})()}function kl(e){return kl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},kl(e)}function Pl(e,t,r){return(t=Sl(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Sl(e){var t=function(e,t){if("object"!=cl(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=cl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==cl(t)?t:t+""}el(sl,"ID",ma.ID),wo.registerClass(Co),wo.registerClass(Vo),wo.registerClass(ei),wo.registerClass(yi),wo.registerClass(xi),wo.registerClass(Li),wo.registerClass(Ui),wo.registerClass(sa),wo.registerClass(ma),_a.registerClass(za),_a.registerClass(es),_a.registerClass(bs),_a.registerClass(Bs),_a.registerClass(Hs),_a.registerClass(su),_a.registerClass(gu),_a.registerClass(Eu),_a.registerClass(sl);var Ol=new n.Vector2,jl=new n.Vector2,xl=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dl(e,t)}(i,e);var t,r,o=bl(i);function i(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return yl(this,i),Pl(wl(t=o.call(this)),"boosterIcon",void 0),Pl(wl(t),"adsBoosterIcon",void 0),Pl(wl(t),"duration",0),Pl(wl(t),"prolongedDuration",0),Pl(wl(t),"adsBased",!1),Pl(wl(t),"pickedUp",!1),Pl(wl(t),"boosterData",null),t.renderOrder=1e3,t.boosterData=e,t.duration=r,t.adsBased=!!n,t}return vl(i,[{key:"timeLeft",get:function(){return this.duration+this.prolongedDuration}},{key:"type",get:function(){var e;return null===(e=this.boosterData)||void 0===e?void 0:e.id},set:function(e){this.boosterData=ul(e)}},{key:"_textureName",get:function(){var e;return null===(e=this.boosterData)||void 0===e?void 0:e.sprite}}],[{key:"createRandom",value:function(){var e=wo.TYPES;return new this(e=e[~~(Math.random()*e.length)])}}]),vl(i,[{key:"createBooster",value:function(){return ll(this.boosterData)}},{key:"preload",value:(r=hl(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([s.yG(this._textureName)]));case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"init",value:(t=hl(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.pickedUp=!1,e.next=3,this.preload();case 3:t=new n.SpriteMaterial({map:s.Hp(this._textureName),transparent:!0}),this.clear(),this.boosterIcon=new n.Sprite(t),this.boosterIcon.position.y=.5,this.boosterIcon.rotation.set(.5*Math.PI,0,0),this.boosterIcon.scale.setScalar(6),this.boosterIcon.renderOrder=100500,this.add(this.boosterIcon),this.adsBased;case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"expire",value:function(){this.duration=0,this.prolongedDuration=0}},{key:"canBePickedUp",value:function(e){var t=e.harvester;return!(!t||t.isDead)&&(!!e.canPickUpBooster(this.boosterData)&&(!!t.isPointInHarvestArea(this.position.x,this.position.z)||this.checkPickupDistance(t.position)))}},{key:"checkPickupDistance",value:function(e){var t=(this.boosterData||{}).pickupRadius,r=void 0===t?2:t;return this._checkDistance2D(e,2*r)}},{key:"updatePlayerNearbyProlongation",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.prolongedDuration>0||this._checkDistance2D(e,t)&&(this.prolongedDuration=r)}},{key:"_checkDistance2D",value:function(e,t){return Ol.set(this.position.x,this.position.z).distanceToSquared(jl.set(e.x,e.z))<=t*t}},{key:"handleDestroy",value:function(){}},{key:"_updateDuration",value:function(e){this.pickedUp||this.timeLeft>0&&(this.duration-=.001*e,this.timeLeft<=0&&this.expire())}},{key:"tick",value:function(e){this._updateDuration(e)}},{key:"expired",get:function(){return this.timeLeft<=0||this.pickedUp}}]),i}(n.Group);function _l(e){return _l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_l(e)}function Tl(e){return function(e){if(Array.isArray(e))return Al(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Cl(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Bl(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Cl(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function Cl(e,t){if(e){if("string"==typeof e)return Al(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Al(e,t):void 0}}function Al(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Ml(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rl(n.key),n)}}function Dl(e,t,r){return(t=Rl(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rl(e){var t=function(e,t){if("object"!=_l(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_l(t)?t:t+""}var El=3.5,Il=20,Ll=3,Fl=3,zl=3,Gl=20,Vl=new Set,Zl=new co,Nl=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Dl(this,"level",void 0),Dl(this,"boosterToSettingsLookup",new Map),Dl(this,"boosterProbabilities",new co),Dl(this,"spawnedPickups",new Set),Dl(this,"activeBoosters",new Set),Dl(this,"buffer",new Set),Dl(this,"nextBooster",null),Dl(this,"timer",0),Dl(this,"running",!1),Dl(this,"handlePickupSpawned",(function(e){t.level.add(e),Or.Z.play("booster-spawn")})),Dl(this,"handlePickupExpired",(function(e){t.removePickup(e)}))}return function(e,t,r){t&&Ml(e.prototype,t),r&&Ml(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"initialize",value:function(e){this.level=e,this.setupBoosterProperties(),kr.X.on("boosterPickupSpawned",this.handlePickupSpawned),kr.X.on("boosterPickupExpired",this.handlePickupExpired)}},{key:"_setupDebugBooster",value:function(){var e=er.c.get("booster"),t=er.c.get("spamBoosters");if(!e||!t)return!1;for(var r=0,n=e?[e]:["bonusPlants","companion","freezeBooster","invulnerability","megaReel","reaper","sawReel","speed","truckMul"];r<n.length;r++){var o=n[r];if(Zl.clear(),this.boosterProbabilities.clear(),this.boosterToSettingsLookup.clear(),o="booster_".concat(o,"_default"),!Zn.Z.boosters.boosters[o])return!1;this.boosterToSettingsLookup.set(o,{adsChance:0,delayBeforeSpawnMin:5,delayBeforeSpawnMax:5}),this.boosterProbabilities.add(1,o),this.nextBooster=o}return this.timer=1,!0}},{key:"setupBoosterProperties",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null===(e=this.level)||void 0===e?void 0:e.levelConfig;if(!this._setupDebugBooster()){var r=t.maxBoosterGroupsToSelect,n=void 0===r?2:r,o=t.boosterSettings,i=void 0===o?[]:o;Zl.clear(),this.boosterProbabilities.clear(),this.boosterToSettingsLookup.clear();var a,s=Bl(i);try{for(s.s();!(a=s.n()).done;){var u=a.value;Zl.add(u.chanceWeight,u.type)}}catch(e){s.e(e)}finally{s.f()}for(var l=0;l<n;l++){var c,f=Zl.rollRandom(),h=Zn.Z.boosters.groups[f]||[],y=Bl(h);try{for(y.s();!(c=y.n()).done;){var p=c.value,v=p.disabled,d=void 0!==v&&v,b=p.chanceWeight,m=p.adsChance,w=p.delayBeforeSpawnMin,g=p.delayBeforeSpawnMax,k=p.booster;d||(this.boosterToSettingsLookup.set(k,{adsChance:m,delayBeforeSpawnMin:w,delayBeforeSpawnMax:g}),this.boosterProbabilities.add(b,k))}}catch(e){y.e(e)}finally{y.f()}Zl.removeElement(f)}this.pickNextRandomBooster()}}},{key:"removeBoosterFromSpawning",value:function(e){this.boosterProbabilities.removeElement(e);var t,r=Bl(this.spawnedPickups);try{for(r.s();!(t=r.n()).done;){t.value.expire()}}catch(e){r.e(e)}finally{r.f()}this.nextBooster=this.boosterProbabilities.rollRandom()}},{key:"_getNextBoosterSpawnDelay",value:function(){var e=er.c.get("spamBoosters");if(e)return Math.max(1,~~e);var t=this.boosterToSettingsLookup.get(this.nextBooster)||{},r=t.delayBeforeSpawnMin,n=void 0===r?0:r,o=t.delayBeforeSpawnMax,i=void 0===o?1:o;return n+Math.random()*(i-n)}},{key:"pickNextRandomBooster",value:function(){this.processSpawningConditions(),this.nextBooster=this.boosterProbabilities.rollRandom(),this.timer=this._getNextBoosterSpawnDelay()}},{key:"startLogic",value:function(){this.running=this.bounds.length>0}},{key:"stopLogic",value:function(){this.running=!1}},{key:"processSpawningConditions",value:function(){Vl.clear();var e,t=Bl(this.boosterProbabilities._lookup.keys());try{for(t.s();!(e=t.n()).done;){var r=e.value;ul(r).spawnConditionsMet(this.level)||Vl.add(r)}}catch(e){t.e(e)}finally{t.f()}var n,o=Bl(Vl);try{for(o.s();!(n=o.n()).done;){var i=n.value;this.removeBoosterFromSpawning(i)}}catch(e){o.e(e)}finally{o.f()}}},{key:"doSpawningLogic",value:function(){var e=this;if(this.nextBooster&&!(this.spawnedPickups.size>10)){for(var t=ul(this.nextBooster),r=t.pickupRadius+Fl,o=this.getRandomSpawnPoint(),i=new n.Vector2(o.x,o.z),a=new n.Vector2,s=r*r,u=0;u<Ll;u++){var l=Tl(this.spawnedPickups).find((function(e){return a.set(e.position.x,e.position.z),i.distanceToSquared(a)<s}));if(!l)break;o=this.getRandomSpawnPoint(o)}o.y=El;var c=this.boosterToSettingsLookup.get(this.nextBooster),f=Math.random(),h=(null==c?void 0:c.adsChance)||0;t.adsBased=h>0&&f<=h,t.adsBased=!1;var y=new xl(t,Il);y.init().then((function(){y.position.copy(o),e.spawnedPickups.add(y),kr.X.emit("boosterPickupSpawned",y)})),this.pickNextRandomBooster()}}},{key:"getRandomSpawnPoint",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new n.Vector3(0,0,0);if(this.bounds.length){var t=this.bounds[~~(Math.random()*this.bounds.length)];return t.getRandomPoint(e)}return e}},{key:"removePickup",value:function(e){this.spawnedPickups.delete(e),e.handleDestroy(),e.removeFromParent()}},{key:"removeBoosterPickups",value:function(e){var t,r=Bl(this.spawnedPickups);try{for(r.s();!(t=r.n()).done;){var n,o=t.value;(null===(n=o.boosterData)||void 0===n?void 0:n.id)===e&&this.removePickup(o)}}catch(e){r.e(e)}finally{r.f()}}},{key:"removeBooster",value:function(e){this.removeBoosterFromSpawning(e),this.removeBoosterPickups(e)}},{key:"handleDestroy",value:function(){kr.X.off("boosterPickupSpawned",this.handlePickupSpawned),kr.X.off("boosterPickupExpired",this.handlePickupExpired);var e,t=Bl(this.spawnedPickups);try{for(t.s();!(e=t.n()).done;){var r=e.value;this.removePickup(r)}}catch(e){t.e(e)}finally{t.f()}this.level=null}},{key:"_updatePickups",value:function(e){var t,r=Bl(this.spawnedPickups);try{for(r.s();!(t=r.n()).done;){var n,o,i=t.value;if(this.level.player){(null===(n=this.level.player)||void 0===n?void 0:n.harvester)&&!(null===(o=this.level.player)||void 0===o?void 0:o.isDead)&&i.updatePlayerNearbyProlongation(this.level.player.harvester.position,Gl,zl);var a,s=Bl(this.level.actors);try{for(s.s();!(a=s.n()).done;){var u=a.value;if(i.canBePickedUp(u))if(this._pickupBooster(i.boosterData,u)){this.removePickup(i),i=null;break}}}catch(e){s.e(e)}finally{s.f()}i&&(i.tick(e),i.expired&&(kr.X.emit("boosterPickupExpired",i),this.removePickup(i)))}else this.removePickup(i)}}catch(e){r.e(e)}finally{r.f()}}},{key:"_pickupBooster",value:function(e,t){if(!t.canUseBoosters)return!1;var r=ll(e);return!r.adsBased||t.isBot?this._applyBooster(r,t):(kr.X.emit("adsBoosterPicked",r,t),null)}},{key:"_applyBooster",value:function(e,t){return t.canApplyBooster(e)?(e=t.applyBooster(e),this.activeBoosters.add(e),e):null}},{key:"_updateBoosters",value:function(e){var t,r=Bl(this.activeBoosters);try{for(r.s();!(t=r.n()).done;){var n=t.value;n.tick(e),n.isExpired&&this.activeBoosters.delete(n)}}catch(e){r.e(e)}finally{r.f()}}},{key:"tick",value:function(e){this.running&&this.level&&(this.timer-=.001*e,this.timer<=0&&this.doSpawningLogic(),this._updatePickups(e),this._updateBoosters(e))}},{key:"bounds",get:function(){var e;return(null===(e=this.level)||void 0===e?void 0:e.boosterBounds)||[]}}]),e}();function Hl(e){return Hl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hl(e)}function Xl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||Wl(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Kl(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Wl(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function Wl(e,t){if(e){if("string"==typeof e)return Ul(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ul(e,t):void 0}}function Ul(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Jl(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ql(n.key),n)}}function ql(e,t,r){return(t=Ql(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ql(e){var t=function(e,t){if("object"!=Hl(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Hl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Hl(t)?t:t+""}var Yl=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ql(this,"name","Player"),ql(this,"skin",1),ql(this,"color",1),ql(this,"isBot",!1),ql(this,"wasRevived",!1),ql(this,"reviveData",null),ql(this,"harvester",null),ql(this,"usedBoosterOnce",!1),ql(this,"boosters",new Map),ql(this,"adsBooster",null)}return function(e,t,r){t&&Jl(e.prototype,t),r&&Jl(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"storeReviveData",value:function(){if(this.harvester){this.reviveData={position:this.harvester.position.clone(),quaternion:this.harvester.quaternion.clone(),harvLevel:this.harvester.harvLevel,trails:this.harvester.trails.map((function(e){return e.cropType})),gatheredCrops:new Map};var e,t=Kl(this.harvester.gatheredCrops);try{for(t.s();!(e=t.n()).done;){var r=Xl(e.value,2),n=r[0],o=r[1];this.reviveData.gatheredCrops.set(n,o)}}catch(e){t.e(e)}finally{t.f()}}}},{key:"canPickUpBooster",value:function(e){if(e.adsBased){if(this.isBot)return!0;if(this.adsBooster)return!1}if(e.cannotBeUsedWhenActive){var t,r=Kl(e.cannotBeUsedWhenActive);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(this.boosters.has(n))return!1}}catch(e){r.e(e)}finally{r.f()}}return!0}},{key:"canApplyBooster",value:function(e){return!!this.canUseBoosters&&(!this.isBot||!e.adsBased)}},{key:"applyBooster",value:function(e){this.usedBoosterOnce=!0;var t=this.boosters.get(e.id);return t?(t.renewFromBooster(e),e=t):e.applyToHarvester(this.harvester),this.boosters.set(e.id,e),e}},{key:"hasBooster",value:function(e){return this.boosters.has(e)}},{key:"handleDestroy",value:function(){this.harvester&&this.harvester.handleDestroy(),this.boosters.clear(),this.reviveData&&this.reviveData.gatheredCrops&&this.reviveData.gatheredCrops.clear()}},{key:"tick",value:function(e){this.harvester&&this.harvester.tick(e)}},{key:"postTick",value:function(e){this.harvester&&this.harvester.postTick(e);var t,r=Kl(this.boosters);try{for(r.s();!(t=r.n()).done;){var n=Xl(t.value,2),o=n[0];n[1].isExpired&&this.boosters.delete(o)}}catch(e){r.e(e)}finally{r.f()}}},{key:"isDead",get:function(){return!this.harvester||this.harvester.isDead}},{key:"harvestProgress",get:function(){var e;return(null===(e=this.harvester)||void 0===e?void 0:e.harvestProgress)||0}},{key:"canLevelUp",get:function(){var e;return!!(null===(e=this.harvester)||void 0===e?void 0:e.canLevelUp)}},{key:"levelProgress",get:function(){var e,t=(null===(e=this.harvester)||void 0===e?void 0:e.levelProgress)||0;return this.canLevelUp?t:1}},{key:"canUseBoosters",get:function(){return!(!this.harvester||this.harvester.isDead)&&(!this.isBot||!this.usedBoosterOnce)}}]),e}();function $l(e){return $l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$l(e)}function ec(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],u=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return s}}(e,t)||cc(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tc(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=cc(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function rc(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function nc(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){rc(i,n,o,a,s,"next",e)}function s(e){rc(i,n,o,a,s,"throw",e)}a(void 0)}))}}function oc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ic(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?oc(Object(r),!0).forEach((function(t){Pc(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oc(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ac(){return ac="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=sc(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},ac.apply(null,arguments)}function sc(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=kc(e)););return e}function uc(e,t,r){if(gc())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var o=new(e.bind.apply(e,n));return r&&dc(o,r.prototype),o}function lc(e){return function(e){if(Array.isArray(e))return fc(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||cc(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cc(e,t){if(e){if("string"==typeof e)return fc(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?fc(e,t):void 0}}function fc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function hc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yc(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sc(n.key),n)}}function pc(e,t,r){return t&&yc(e.prototype,t),r&&yc(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vc(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dc(e,t)}function dc(e,t){return dc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},dc(e,t)}function bc(e){var t=gc();return function(){var r,n=kc(e);if(t){var o=kc(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return mc(this,r)}}function mc(e,t){if(t&&("object"==$l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return wc(e)}function wc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gc(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(gc=function(){return!!e})()}function kc(e){return kc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},kc(e)}function Pc(e,t,r){return(t=Sc(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Sc(e){var t=function(e,t){if("object"!=$l(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=$l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$l(t)?t:t+""}var Oc=_.nS,jc=new n.Vector3,xc=new n.Quaternion,_c=new n.Quaternion,Tc=(n.Group,function(e){vc(f,e);var t,r,a,u,l,c=bc(f);function f(e,t){var r;return hc(this,f),Pc(wc(r=c.call(this,e)),"harvesterConfig",{skin:1,color:1,startBigger:!1}),Pc(wc(r),"actors",[]),Pc(wc(r),"spawnPositions",[]),Pc(wc(r),"freeSpawnPositions",[]),Pc(wc(r),"fields",[]),Pc(wc(r),"camera",null),Pc(wc(r),"respawnQueue",[]),Pc(wc(r),"droppedSheafs",[]),Pc(wc(r),"ready",!1),Pc(wc(r),"controller",null),Pc(wc(r),"cameraOffset",(new n.Vector3).copy(Oc.offset)),Pc(wc(r),"cameraLevelOffset",new n.Vector3(0,0,0)),Pc(wc(r),"running",!1),Pc(wc(r),"roundTime",_.GG),Pc(wc(r),"playTime",0),Pc(wc(r),"boosterBounds",[]),Pc(wc(r),"boosterSpawner",void 0),Pc(wc(r),"_plantParticlesPool",new Map),Pc(wc(r),"handleRevive",(function(e){r.player&&(r.player.wasRevived=!0,e?(r.revivePlayer(),r.running=!0):(r.player.harvester.isDead=!1,r.killHarvester(r.player.harvester)))})),Pc(wc(r),"_cameraLevelZoom",0),Pc(wc(r),"_targetCameraLevelZoom",0),r.levelConfig=ic({},t.level),r.harvesterConfig=ic({},t.harvester),r.noParticles=!!er.c.get("noParticles"),r.onHarvest=r.onHarvest.bind(wc(r)),r.handleCollisions=r.handleCollisions.bind(wc(r)),r.visible=!1,er.c.has("infiniteTime")&&(r.roundTime=1/0),r}return pc(f,[{key:"player",get:function(){return this.actors[0]}},{key:"leaderboard",get:function(){var e=lc(this.actors);return e.sort((function(e,t){return t.harvestProgress-e.harvestProgress})),e.map((function(e,t){return{name:e.name||"",progress:e.harvestProgress,isPlayer:!e.isBot}}))}},{key:"timeLeft",get:function(){return Math.max(0,this.roundTime-this.playTime)}}]),pc(f,[{key:"init",value:(l=nc(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,ac(kc(f.prototype),"init",this).call(this);case 3:return this.loading=this.preload(),e.next=6,this.loading;case 6:return this.loading=null,this.createPhysics(),this.initSpawnPositions(),this.createColliders(),this.spawnFields(),e.next=13,this.initBoosters();case 13:return this.initPlayers(),e.next=16,this.spawnHarvesters();case 16:return this.updateCamera(!0),this.ready=!0,this.visible=!0,e.next=21,Promise.all(lc(this.fields.map((function(e){return e.init()}))));case 21:this.running=!0,this.boosterSpawner.startLogic(),this.addShadows();case 24:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"addShadows",value:function(){var e=[];tr.Z.findMesh(this,e),tr.Z.addShadows(e,!0,!0),e=[];var t,r=tc(this.fields);try{for(r.s();!(t=r.n()).done;){var n=t.value;tr.Z.findMesh(n,e)}}catch(e){r.e(e)}finally{r.f()}tr.Z.addShadows(e,!1,!1)}},{key:"preload",value:(u=nc(regeneratorRuntime.mark((function e(){var t,r,n,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=new Set,r=tc(this.levelConfig.plants);try{for(r.s();!(n=r.n()).done;)o=n.value,t.add(o.type)}catch(e){r.e(e)}finally{r.f()}return t=lc(t),a=new Array(4).map((function(e,t){return"harvesters/harvester".concat(t+1)})),e.next=7,Promise.all([s.yG("textures/farm-simple"),s.yG("textures/farm-combine")]);case 7:return e.next=9,i.Z.createScene("boomHarvester");case 9:return e.abrupt("return",Promise.all([].concat(lc(a.map((function(e){return(0,s.u7)(e)}))),lc(t.map((function(e){return(0,s.u7)("plants/".concat(e))}))),lc(t.map((function(e){return(0,s.u7)("sheafs/".concat(e))}))),[s.u7("harvesters/trailer")])));case 10:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"createPhysics",value:function(){this.world=new $t(this),this.world.init(),er.c.enabled&&this.world.startDebug();var e=this.world.createCubeBody(0,new n.Vector3(1e3,100,1e3));this.world.setBodyPosition(e,new n.Vector3(0,-50,0)),this.world.addBody(e),this.world.addEventListener("collisionStart",this.handleCollisions)}},{key:"createColliders",value:function(){this.colliders=this.queryTagAll("collider",!0);var e,t=tc(this.colliders);try{for(t.s();!(e=t.n()).done;){var r=e.value;r.isWall=!0,r.updateMatrixWorld();for(var o=r.parent;o;)o.updateMatrixWorld(),o=o.parent;var i=(new n.Box3).setFromObject(r),a=this.world.createCubeBody(0,i.getSize(new n.Vector3));a.collisionFilterGroup=W,a.collisionFilterMask=U,r.body=a,this.world.setBodyPosition(a,i.getCenter(new n.Vector3)),this.world.addBody(a),r.computeBoundsTree()}}catch(e){t.e(e)}finally{t.f()}}},{key:"setCamera",value:function(e,t,r){this.camera=e,this.animLightGroup=t,this.directional=r}},{key:"getChildByFileId",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,n=tc(r.children);try{for(n.s();!(t=n.n()).done;){var o=t.value;if(o.getProp&&o.getProp("fileID")===e)return o;var i=this.getChildByFileId(e,o);if(i)return i}}catch(e){n.e(e)}finally{n.f()}return null}},{key:"initSpawnPositions",value:function(){var e=this.getProp("harvesterSpawnDots");if(e){var t,r=tc(e=JSON.parse(e));try{for(r.s();!(t=r.n()).done;){var o=t.value,i=this.getChildByFileId(o).getWorldPosition(new n.Vector3);i=this.worldToLocal(i),this.spawnPositions.push(i)}}catch(e){r.e(e)}finally{r.f()}}}},{key:"getNextSpawnPosition",value:function(){var e,t=this,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(r&&this.player&&this.player.harvester){var n=this.spawnPositions.map((function(e){return e.distanceToSquared(t.player.harvester.position)})),o=Math.max.apply(Math,lc(n));return this.spawnPositions[n.indexOf(o)]}0===this.freeSpawnPositions.length&&((e=this.freeSpawnPositions).push.apply(e,lc(this.spawnPositions)),this.freeSpawnPositions.sort((function(e,t){return.5-Math.random()})));return this.freeSpawnPositions.shift()}},{key:"initPlayers",value:function(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.spawnPositions.length-1;(null===(e=this.levelConfig)||void 0===e?void 0:e.botsCount)&&(r=Math.min(3,null===(t=this.levelConfig)||void 0===t?void 0:t.botsCount));this.actors.splice(0),er.c.has("bots")&&(r=~~er.c.get("bots")),r=Math.max(0,Math.min(this.spawnPositions.length-1,~~r));var n=new Yl;n.name=this.harvesterConfig.name||"Player",n.skin=this.harvesterConfig.skin||1,n.color=this.harvesterConfig.color||1,n.startBigger=!!this.harvesterConfig.startBigger,n.isBot=!1,this.actors.push(n);var o=[1,2,3,4,5,6].filter((function(e){return e!==n.color}));o.sort((function(){return.5-Math.random()})),this.allBotsNames=lc(Vn),this.allBotsNames.sort((function(){return.5-Math.random()}));for(var i=0;i<r;i++){var a=new Yl;a.name=this.allBotsNames.shift(),a.skin=1+~~(10*Math.random()),a.color=o.shift()||1+~~(6*Math.random()),a.isBot=!0,this.actors.push(a)}}},{key:"spawnHarvesters",value:(a=nc(regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.actors.map((function(e){return r.spawnHarvester(e)})),e.abrupt("return",Promise.all(t));case 2:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"spawnHarvester",value:(r=nc(regeneratorRuntime.mark((function e(t){var r,n,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]&&o[1],n=new tn(t,this),t.harvester=n,n.spawnPosition.copy(this.getNextSpawnPosition(n.isBot&&r)),n.rotation.y=Math.PI,e.next=7,n.init();case 7:return this.add(n),n.setInvulnerable(!0,500),r&&(t.name=this.allBotsNames.shift()),e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"getRandomPlant",value:function(){var e,t=0,r=[],n=0,o=tc(this.levelConfig.plants);try{for(o.s();!(e=o.n()).done;){var i=e.value;t+=i.chance,r.push({plant:i.type,min:n,max:t}),n=t}}catch(e){o.e(e)}finally{o.f()}for(var a=Math.random()*t,s=0,u=r;s<u.length;s++){var l=u[s];if(a>=l.min&&a<l.max)return l.plant}}},{key:"_getShuffledPlantsList",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.levelConfig.plants.length,r=0,n=new Map,o=[],i=tc(this.levelConfig.plants);try{for(i.s();!(e=i.n()).done;){var a=e.value,s=a.type,u=a.chance;r+=u,n.set(s,~~n.get(s)+u)}}catch(e){i.e(e)}finally{i.f()}(n=lc(n)).sort((function(e,t){var r=ec(e,2),n=(r[0],r[1]),o=ec(t,2);o[0];return n-o[1]}));var l,c=tc(n);try{for(c.s();!(l=c.n()).done;){var f=ec(l.value,2),h=f[0],y=f[1];y=Math.max(1,Math.round(t*(y/r))),o.push.apply(o,lc(new Array(y).fill(h,0,y)))}}catch(e){c.e(e)}finally{c.f()}return o.splice(t),o.sort((function(){return.5-Math.random()})),o}},{key:"spawnFields",value:function(){var e=this.getProp("groupsPlantsSpawnDots");if(e){e=JSON.parse(e);var t,r=this._getShuffledPlantsList(e.length),o=tc(e);try{for(o.s();!(t=o.n()).done;){var i,a=t.value,s=this.getProp("theme")||"default",u=er.c.get("plant")||r.shift()||this.getRandomPlant(),l=tc(a);try{for(l.s();!(i=l.n()).done;){var c=i.value,f=this.getChildByFileId(c.fileID).getWorldPosition(new n.Vector3);f=this.worldToLocal(f);var h=new Pn(u,s);h.position.copy(f),h.rotation.y=c.angle,this.add(h),this.fields.push(h)}}catch(e){l.e(e)}finally{l.f()}}}catch(e){o.e(e)}finally{o.f()}kr.X.on("harvest",this.onHarvest)}}},{key:"initBoosters",value:(t=nc(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.boosterBounds.splice(0),t=this.getProp("boosterBounds");try{t=JSON.parse(t)}catch(e){t=null}this.boosterBounds=(t||[]).map((function(e){return new eo(e)})),this.boosterSpawner=new Nl,this.boosterSpawner.initialize(this);case 6:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"setPlayerController",value:function(e){this.controller=e,this.player&&this.player.harvester&&(e.player=this.player.harvester)}},{key:"updateCamera",value:function(){var e;if(this.camera&&(null===(e=this.player)||void 0===e?void 0:e.harvester)){if(er.c.has("fly"))return this.camera.position.set(90,550,-80),void this.camera.lookAt(100,0,-80);jc.copy(this.player.harvester.position).add(this.cameraOffset).add(this.cameraLevelOffset),this.camera.position.lerp(jc,.1),xc.copy(this.camera.quaternion),this.camera.lookAt(this.player.harvester.position),_c.copy(this.camera.quaternion),this.camera.quaternion.copy(xc),this.camera.quaternion.slerp(_c,.1),this.camera.position.copy(jc),this.camera.lookAt(this.player.harvester.position),this.animLightGroup.position.copy(this.player.harvester.position),this.directional.target=this.player.harvester}}},{key:"_getPlantParticle",value:function(e){this._plantParticlesPool.has(e.plantData.type)||this._plantParticlesPool.set(e.plantData.type,{material:e.plantMaterial.clone(),particles:[]});var t=this._plantParticlesPool.get(e.plantData.type),r=t.material,o=t.particles.shift();return o||((o=new n.Mesh(e.plantGeometry,r)).plant=e.plantData.type),o}},{key:"_freePlantParticle",value:function(e){e.removeFromParent(),this._plantParticlesPool.get(e.plant).particles.push(e)}},{key:"_clearPlantParticlesPool",value:function(){var e,t=tc(this._plantParticlesPool);try{for(t.s();!(e=t.n()).done;){var r=ec(e.value,2),n=(r[0],r[1]),o=n.material,i=n.particles;o.dispose();var a,s=tc(i);try{for(s.s();!(a=s.n()).done;){a.value.removeFromParent()}}catch(e){s.e(e)}finally{s.f()}}}catch(e){t.e(e)}finally{t.f()}this._plantParticlesPool.clear()}},{key:"onHarvest",value:function(e){var t=this;if(this.ready&&!this.noParticles){var r=e.plants,n=e.field;if(r.length>50){var i=Math.ceil(r.length/50);r=r.filter((function(e,t){return t%i==0}))}var a,s=Math.min(3,Math.ceil((50-r.length)/10)),u=tc(r);try{for(u.s();!(a=u.n()).done;){var l=a.value;jc.set(l.x,0,l.z),n.localToWorld(jc),this.worldToLocal(jc);for(var c=1+~~(Math.random()*s),f=function(e){var r=t._getPlantParticle(n);if(!r)return"continue";r.position.copy(jc),r.rotation.y=l.angle,r.scale.setScalar(l.scale),e>0&&(r.rotation.y+=Math.random()*Math.PI*2,r.scale.setScalar(l.scale*(.5+.3*Math.random()))),t.add(r);var i=550+200*Math.random();new o.kX(r.position).to({y:4+4*Math.random(),x:jc.x+3*Math.random()-1.5,z:jc.z+3*Math.random()-1.5},i).delay(70*e).easing(o.oY.Quadratic.Out).start(),new o.kX(r.scale).to({x:0,y:0,z:0},i).delay(70*e).easing(o.oY.Quadratic.In).start().onComplete((function(){return t._freePlantParticle(r)}))},h=0;h<c;h++)f(h)}}catch(e){u.e(e)}finally{u.f()}}}},{key:"revivePlayer",value:function(){this.player.harvester.revive(this.player.reviveData)}},{key:"killHarvester",value:function(e){var t=this;if(e&&!e.isDead){e.isDead=!0;var r=this.actors.find((function(t){return t.harvester===e}));if(r){var n=!r.isBot,o=n?Gn.createDeathResult(this):null;if(n?(this.running=!1,Or.Z.play("harvester-crush")):Or.Z.play("harvester-crush",!1,.2),n&&!r.wasRevived&&this.timeLeft>1)return r.storeReviveData(),r.wasRevived=!0,kr.X.once("reviveResult",this.handleRevive,this),void kr.X.emit("reviveRequested");e.explode(),r.harvester=null,e.handleDestroy(),e.showDestroyAnimation().then((function(){t.remove(e)})),n?new Sr.Z(1500).once("finish",(function(){kr.X.emit("gameOver",o),o.harvestedPlants.clear()})):(r.respawnTime=rn.Z.liveTime+2e3,this.respawnQueue.push(r))}}}},{key:"_handleActorsCollision",value:function(e,t){if(!(e.isDead||t.isDead||e.isInvulnerable||t.isInvulnerable))for(var r=0,n=[e.checkWhoWillDie(t),t.checkWhoWillDie(e)];r<n.length;r++){var o=n[r];o&&this.killHarvester(o)}}},{key:"_handleTrailCollision",value:function(e,t){var r;if(!e.isDead&&!e.isInvulnerable){var n=e===t.harvester;if(!(n&&t.trailIndex<3)){var o=e.hasSaw;if(n||!o||(null===(r=t.harvester)||void 0===r?void 0:r.isInvulnerable))this.killHarvester(e);else{var i=Math.max(0,t.harvester.trails.indexOf(t));t.harvester.cutTrailFromIndex(i)}}}}},{key:"handleCollisions",value:function(e){var t,r,n,o;if(this.running){var i=e.bodyA,a=e.bodyB;if(i&&a&&(null===(t=i.userData)||void 0===t?void 0:t.view)&&(null===(r=a.userData)||void 0===r?void 0:r.view)){var s=null===(n=i.userData)||void 0===n?void 0:n.view,u=null===(o=a.userData)||void 0===o?void 0:o.view;if(s.isActor&&u.isActor)return this._handleActorsCollision(s,u);var l=s.isActor||u.isActor?s.isActor?s:u:null;if(l){var c=s.isTrail||u.isTrail?s.isTrail?s:u:null;return l&&c?this._handleTrailCollision(l,c):void 0}}}}},{key:"collectSheaf",value:function(e,t){var r=this.droppedSheafs.indexOf(t);r>=0&&this.droppedSheafs.splice(r,1),t.handleDestroy(),this.remove(t),e.collectSheaf(t),e.isBot||Or.Z.play("cut")}},{key:"updateRespawn",value:function(){var e=this;if(this.respawnQueue.length){var t=this.respawnQueue.filter((function(e){return e.respawnTime<rn.Z.liveTime}));if(t.length){this.respawnQueue=this.respawnQueue.filter((function(e){return!t.includes(e)})),t.sort((function(e,t){return~~e.isBot-~~t.isBot}));var r,n=tc(t);try{for(n.s();!(r=n.n()).done;){var o=r.value;o.respawnTime=void 0,this.spawnHarvester(o,!0).then((function(t){t.isBot||e.setPlayerController(e.controller)}))}}catch(e){n.e(e)}finally{n.f()}}}}},{key:"spawnSheaf",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_.gL.HJ;t=Math.max(0,~~t),e||(e=(e=this.fields.map((function(e){return e.plantData.type})))[Math.floor(Math.random()*e.length)]);var r=new En(this,e,t);return this.add(r),this.droppedSheafs.push(r),r}},{key:"harvest",value:function(){var e,t=tc(this.actors);try{for(t.s();!(e=t.n()).done;){var r=e.value;if(!r.isDead){var n,o=r.harvester,i=tc(this.fields);try{for(i.s();!(n=i.n()).done;)for(var a=n.value,s=a.harvest(o),u=0;u<s;u++)o.gatherHarvestable(a.plantData.type,a.plantData.plantCost)}catch(e){i.e(e)}finally{i.f()}var l,c=tc(this.droppedSheafs);try{for(c.s();!(l=c.n()).done;){var f=l.value;o.isPointInHarvestArea(f.position.x,f.position.z)&&this.collectSheaf(o,f)}}catch(e){c.e(e)}finally{c.f()}}}}catch(e){t.e(e)}finally{t.f()}}},{key:"addLevelUpTarget",value:function(){var e=new n.BoxGeometry(1e-4,1e-4,1e-4),t=new n.MeshBasicMaterial({color:65280}),r=new n.Mesh(e,t);return this.add(r),r}},{key:"removeLevelUpTarget",value:function(e){this.remove(e)}},{key:"updatePlayTime",value:function(e){if(this.playTime+=e/1e3,!this.timeLeft){this.running=!1;var t=Gn.createEndResult(this);kr.X.emit("gameOver",t),t.harvestedPlants.clear();var r,n=tc(this.actors);try{for(n.s();!(r=n.n()).done;){var o,i=r.value;if(i.harvester)null===(o=i.harvester.view)||void 0===o||o.stopHarvestAnimations()}}catch(e){n.e(e)}finally{n.f()}}}},{key:"handleDestroy",value:function(){var e,t,r=tc(this.fields);try{for(r.s();!(t=r.n()).done;){t.value.dispose()}}catch(e){r.e(e)}finally{r.f()}null===(e=this.boosterSpawner)||void 0===e||e.handleDestroy(),this.boosterSpawner=null,kr.X.off("reviveResult",this.handleRevive,this),kr.X.off("harvest",this.onHarvest),this._clearPlantParticlesPool(),this.world&&this.world.removeEventListener("collisionStart",this.handleCollisions),this.directional&&(this.directional.target=null,this.directional=null),this.camera=null;var n,o=tc(this.actors);try{for(o.s();!(n=o.n()).done;){n.value.handleDestroy()}}catch(e){o.e(e)}finally{o.f()}this.actors.length=0,this.controller&&(this.controller.player=null,this.controller=null)}},{key:"_updateCameraLevelZoom",value:function(e){var t,r;if(this._targetCameraLevelZoom=_.nS.levelZoomStep*Math.max(0,~~(null===(t=this.player)||void 0===t||null===(r=t.harvester)||void 0===r?void 0:r.harvLevel)-1),this._cameraLevelZoom!==this._targetCameraLevelZoom){var n=_.nS.levelZoomSpeed*e/1e3;this._cameraLevelZoom=x.N.Lerp(this._cameraLevelZoom,this._targetCameraLevelZoom,n),Math.abs(this._targetCameraLevelZoom-this._cameraLevelZoom)<.001&&(this._cameraLevelZoom=this._targetCameraLevelZoom),this.cameraLevelOffset.copy(this.cameraOffset).multiplyScalar(this._cameraLevelZoom)}}},{key:"__drawBasicDebug",value:function(){}},{key:"tick",value:function(e){if(this.running){this.updatePlayTime(e),this.boosterSpawner&&this.boosterSpawner.tick(e),this.controller&&this.controller.tick(e);var t,r=tc(this.actors);try{for(r.s();!(t=r.n()).done;){t.value.tick(e)}}catch(e){r.e(e)}finally{r.f()}this.harvest(),this._updateCameraLevelZoom(e),this.world&&this.world.tick(e);var n,o=tc(this.actors);try{for(o.s();!(n=o.n()).done;){n.value.postTick(e)}}catch(e){o.e(e)}finally{o.f()}this.updateCamera(),this.updateRespawn()}}},{key:"totalCrops",get:function(){var e,t=0,r=tc(this.fields);try{for(r.s();!(e=r.n()).done;){t+=e.value.totalCrops}}catch(e){r.e(e)}finally{r.f()}return t}},{key:"collectedCrops",get:function(){var e,t=0,r=tc(this.fields);try{for(r.s();!(e=r.n()).done;){t+=e.value.collectedCrops}}catch(e){r.e(e)}finally{r.f()}return t}},{key:"cropsLeft",get:function(){var e,t=0,r=tc(this.fields);try{for(r.s();!(e=r.n()).done;){t+=e.value.cropsLeft}}catch(e){r.e(e)}finally{r.f()}return t}}]),f}(i.Z.Component3D));Pc(Tc,"defaultProps",{theme:{type:"list",list:["default","snow"],value:"default"}}),Pc(Tc,"STATIC_DELTA",1e3/60);const Bc=Tc;r(6863);const Cc={Level:Bc}}}]);